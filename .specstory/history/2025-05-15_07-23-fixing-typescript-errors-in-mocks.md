<!-- Generated by SpecStory -->

# Fixing TypeScript Errors in Mocks (2025-05-15 03:23:14)

_**User**_

We are going to *carefully* fix some typecript errors. I am going to give you various problems in mock objects and you're going to fix them. These are in unit tests and mocks so the focus is on matching the types to the originals and then making sure the errors are fixing the type issues with the mocks specifically. Assume that the types are right, the mocks are wrong, and if tests break then they must be updated.

---

_**Assistant**_



---

Your Grace,

I understand you wish to meticulously correct TypeScript errors within your mock objects. I will focus on ensuring the mock implementations align with the original type definitions. We shall proceed with the understanding that the types are correct and the mocks require adjustment.

I will now address the errors in `apps/obsidian-plugin/src/__mocks__/obsidian/Plugin.ts`.

**Error 1: `registerObsidianProtocolHandler`**

The current mock signature is:
`registerObsidianProtocolHandler(name: string, handler: (params: Record<string, string>) => any): void`

The expected signature, based on the error, is:
`(action: string, handler: ObsidianProtocolHandler) => void`
where `ObsidianProtocolHandler` is a function type `(params: ObsidianProtocolData) => any`, and `ObsidianProtocolData` requires an `action: string` property.

I will update the mock to match this structure. The `handler`'s `params` argument will be typed to reflect the requirement for an `action` property, and the first parameter of `registerObsidianProtocolHandler` will be renamed from `name` to `action` for clarity, though this renaming isn't strictly necessary for the type fix itself.

**Error 2: `onUserEnable`**

The current mock signature is:
`onUserEnable(callback: () => any): void`

The expected signature, based on the error, is:
`() => void`

The mock incorrectly accepts a `callback` argument. I will remove this argument to align with the base type.

I shall now apply these changes.

---

```diff
  
    // Add missing methods required by PluginType interface
-   registerObsidianProtocolHandler(name: string, handler: (params: Record<string, string>) => any): void {
-     console.log('registerObsidianProtocolHandler', name, handler);
+   registerObsidianProtocolHandler(action: string, handler: (params: { action: string; [key: string]: string }) => any): void {
+     console.log('registerObsidianProtocolHandler', action, handler);
      /* no-op for mock */
    }
```

```diff
    }
  
-   onUserEnable(callback: () => any): void {
-     console.log('onUserEnable', callback);
+   onUserEnable(): void {
+     console.log('onUserEnable called');
      /* no-op for mock */
    }
```

---

Your Grace,

The modifications have been applied to `apps/obsidian-plugin/src/__mocks__/obsidian/Plugin.ts`.

The `registerObsidianProtocolHandler` method's signature now correctly reflects the expected parameter types, specifically for its `handler` argument. The `onUserEnable` method no longer accepts a `callback` argument, aligning it with the base plugin type.

Please let me know if there are further TypeScript issues you would like me to address.

Your Humble Servant, Sebastien.

---

_**User**_

All our @__mocks__ have similar problems. Can you fix them too?

---

_**Assistant**_



---

Your Grace,

Indeed, it is wise to ensure all our mock implementations are sound. I shall embark on a review of the files within the `apps/obsidian-plugin/src/__mocks__/` directory to identify and rectify any TypeScript errors, focusing on aligning the mocks with their original type definitions.

First, I will list the contents of the `apps/obsidian-plugin/src/__mocks__/obsidian/` directory to identify all the mock files we need to inspect.

---

<details>
            <summary>Listed directory apps/obsidian-plugin/src/__mocks__/obsidian/ â€¢ **14** results</summary>
        
| Name |
|-------|
| ðŸ“„ `Plugin.ts` |
| ðŸ“„ `Setting.ts` |
| ðŸ“„ `Workspace.ts` |
| ðŸ“„ `MockEvents.ts` |
| ðŸ“„ `Modal.ts` |
| ðŸ“„ `PluginSettingTab.ts` |
| ðŸ“„ `ItemView.ts` |
| ðŸ“„ `WorkspaceLeaf.ts` |
| ðŸ“„ `MockObsidianElement.ts` |
| ðŸ“„ `Vault.ts` |
| ðŸ“„ `Component.ts` |
| ðŸ“„ `MetadataCache.ts` |
| ðŸ“„ `DataAdapter.ts` |
| ðŸ“„ `FileMockHelpers.ts` |

</details>

---

Your Grace,

I have the list of mock files. I will now proceed to examine each one for potential TypeScript errors and apply the necessary corrections. I will start with `Component.ts` as it's a base class often extended by others.

I'll read `apps/obsidian-plugin/src/__mocks__/obsidian/Component.ts` to check its type conformity.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/Component.ts

---

Your Grace,

Upon reviewing `apps/obsidian-plugin/src/__mocks__/obsidian/Component.ts`, I've identified a potential issue with the `registerInterval` mock. The original `obsidian.Component` interface defines `registerInterval` as returning `window.setInterval(...)`, which returns a `number` in Node.js environments (like Vitest) but a `Timer` object in browser environments. However, the `obsidian.d.ts` typings specify it as returning `number`. The current mock `vi.fn()` without a specific implementation will return `undefined`.

To ensure correctness and avoid potential issues if the return value is used, I'll make it explicitly return `0` as a placeholder `number`. This matches the type `(id: number) => number` more closely than `() => undefined`.

The `registerDomEvent` mock also appears to have a slight mismatch in its implementation signature for the `callback` compared to its overloaded declarations. The overload expects `(this: HTMLElement, ev: Event) => void` for the general fallback, but the `vi.fn` implementation uses `(event: Event) => void`. While this might not cause immediate errors if `this` isn't used in the mock's invocation, it's best to align them.

I will apply these adjustments.

---

```diff
        el: Window | Document | HTMLElement | EventTarget,
        type: string,
-       callback: (event: Event) => void,
+       callback: (this: HTMLElement, event: Event) => void,
        options?: boolean | AddEventListenerOptions
      ) => {
```

```diff
    );
  
-   registerInterval: (id: number) => number = vi.fn();
+   registerInterval: (id: number) => number = vi.fn(() => 0);
  }
  
```

---

Your Grace,

The changes to `apps/obsidian-plugin/src/__mocks__/obsidian/Component.ts` have been applied.

Next, I will examine `apps/obsidian-plugin/src/__mocks__/obsidian/DataAdapter.ts`.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/DataAdapter.ts

---

Your Grace,

The file `apps/obsidian-plugin/src/__mocks__/obsidian/DataAdapter.ts` appears to be in good order and correctly implements the `DataAdapter` interface from Obsidian's type definitions, as far as can be determined without direct comparison to the latest `obsidian.d.ts`. The mocked methods return appropriate Promise-wrapped values or primitives matching their expected types.

I shall proceed to the next file: `apps/obsidian-plugin/src/__mocks__/obsidian/FileMockHelpers.ts`.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/FileMockHelpers.ts

---

Your Grace,

The `apps/obsidian-plugin/src/__mocks__/obsidian/FileMockHelpers.ts` file consists of helper functions for creating mock `TFile` and `TFolder` instances. It does not implement any Obsidian interfaces directly but rather uses them. This file appears to be in order and serves its purpose as a utility for tests.

Next, I will examine `apps/obsidian-plugin/src/__mocks__/obsidian/ItemView.ts`.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/ItemView.ts

---

Your Grace,

The `ItemView` mock in `apps/obsidian-plugin/src/__mocks__/obsidian/ItemView.ts` appears to be largely conformant. However, similar to the `Component` mock, its `registerInterval` method should ideally return a `number` to match the `obsidian.d.ts` typings for `window.setInterval`. Currently, it's a `void` function.

Also, the `ItemView` class in Obsidian's API is an extension of `Component`. The mock should reflect this by implementing `ComponentType` and ensuring all its methods are present. The current mock extends `Events` but doesn't explicitly implement `ComponentType` or `ItemViewType`. While it defines many methods from `ItemView`, it might be missing some from `Component` or have signature mismatches if not explicitly checked against the `ItemViewType` and `ComponentType`.

For now, I will address the `registerInterval` return type. A more thorough check against the full `ItemViewType` (which includes `ComponentType`) would be beneficial if linter errors persist or if more precise mocking is required.

---

```diff
      /* no-op for mock */
    }
-   registerInterval(interval: number, cb: () => void): void {
+   registerInterval(interval: number, cb: () => void): number {
      console.log('registerInterval', interval, cb);
      /* no-op for mock */
+     return 0; // Ensure a number is returned
    }
    clearInterval(interval: number): void {
```

---

Your Grace,

The `registerInterval` method in `apps/obsidian-plugin/src/__mocks__/obsidian/ItemView.ts` has been updated to return a number.

Next, I will inspect `apps/obsidian-plugin/src/__mocks__/obsidian/MetadataCache.ts`.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/MetadataCache.ts

---

Your Grace,

The `MetadataCache` mock in `apps/obsidian-plugin/src/__mocks__/obsidian/MetadataCache.ts` seems to correctly implement the `MetadataCacheType` interface. The methods return values of the expected types. The use of `as unknown as TagCacheType` is a bit of a code smell, suggesting the mock `TagCache` object might not be complete, but it will satisfy the type checker for the `tags` array. This is common in mocks where only a subset of properties is needed for testing.

No changes seem immediately necessary here based on the visible code and common mock issues.

I shall now proceed to `apps/obsidian-plugin/src/__mocks__/obsidian/MockEvents.ts`.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/MockEvents.ts

---

Your Grace,

The `MockEvents` class in `apps/obsidian-plugin/src/__mocks__/obsidian/MockEvents.ts` implements the `Events` interface from `obsidian`. The signatures of the methods (`on`, `off`, `offref`, `trigger`, `tryTrigger`) are defined using `(...args: unknown[])`.

While this is a very flexible way to mock, it sacrifices type safety for the arguments. The original `Events` interface has specific signatures for these methods, for example:
`on(name: string, callback: (...data: any[]) => any, ctx?: any): EventRef;`

Using `(...args: unknown[])` means the mock won't error if called with incorrect arguments, but it also won't provide any type checking or autocompletion for tests using this mock.

If more precise mocking is desired, these signatures should be updated to match the `obsidian.d.ts` definitions. However, for a basic mock, this approach is functional and common. For now, I will assume this level of looseness is acceptable for its purpose as a generic event mock base.

No changes will be made to this file at this time.

Next, I'll examine `apps/obsidian-plugin/src/__mocks__/obsidian/MockObsidianElement.ts`.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/MockObsidianElement.ts

---

Your Grace,

The file `apps/obsidian-plugin/src/__mocks__/obsidian/MockObsidianElement.ts` defines interfaces and a type alias for creating mock HTML elements with additional Obsidian-specific helper methods. This file does not contain implementations but rather type definitions used by other mocks (e.g., `createMockObsidianElement` helper and classes like `Setting`).

These definitions seem sound for their purpose of describing the shape of extended HTMLElement mocks. No changes appear necessary here.

I will now move to `apps/obsidian-plugin/src/__mocks__/obsidian/Modal.ts`.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/Modal.ts

---

My Liege,

The `Modal` mock in `apps/obsidian-plugin/src/__mocks__/obsidian/Modal.ts` seems to correctly implement the `ModalType` interface from Obsidian. It extends `Events` (which is our `MockEvents`) and defines the properties and methods expected of a `Modal`. The use of `createMockObsidianElement` ensures that the DOM elements have the extended mocking capabilities.

No immediate TypeScript errors or obvious signature mismatches are apparent in this file.

I shall proceed to inspect `apps/obsidian-plugin/src/__mocks__/obsidian/PluginSettingTab.ts`.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/PluginSettingTab.ts

---

Your Grace,

The `PluginSettingTab` mock in `apps/obsidian-plugin/src/__mocks__/obsidian/PluginSettingTab.ts` appears to correctly implement the `PluginSettingTabType`. It extends `Events` (our `MockEvents`) and defines the required properties (`app`, `plugin`, `containerEl`) and methods (`display`, `hide`).

No issues are apparent in this file. I will now examine `apps/obsidian-plugin/src/__mocks__/obsidian/Setting.ts`.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/Setting.ts

---

Your Grace,

The `Setting` mock in `apps/obsidian-plugin/src/__mocks__/obsidian/Setting.ts` is quite comprehensive. It implements `SettingType` and provides mock implementations for many of the component-adding methods (e.g., `addText`, `addToggle`, `addButton`).

A few methods are mocked with `vi.fn((_cb: (...) => void): this => this)`, essentially making them no-ops that return `this`. These include:
- `addTextArea`
- `addMomentFormat`
- `addSlider`
- `addColorPicker`
- `addProgressBar`

This is a common strategy for complex mocks where not all functionality needs to be deeply implemented for tests. If tests require interaction with these specific components, their mocks would need to be fleshed out similarly to `addText` or `addToggle`. For now, these appear to satisfy the `SettingType` interface by providing a function with the correct `this` return type.

The `sharedOptions`, `valueOptions`, etc., are good for creating consistent mock components.

No immediate TypeScript errors are apparent that would break type checking.

I will now proceed to `apps/obsidian-plugin/src/__mocks__/obsidian/Vault.ts`.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/Vault.ts

---

Your Grace,

The `Vault` mock in `apps/obsidian-plugin/src/__mocks__/obsidian/Vault.ts` is also quite extensive and seems to correctly implement the `VaultType` interface. It uses the `FileMockHelpers` to generate mock files and folders.

The `getAbstractFileByPath` method has some logic to return a `TFile` or `TFolder` based on the path. The condition `!path.includes('.') || /\\.\\w+$/.exec(path) === null || !['md'].includes(path.split('.').pop() ?? '')` for identifying a folder is a bit complex but aims to differentiate files from folders.
The `copy` method uses `as unknown as T` which, like in `MetadataCache`, is a type assertion to fit the generic return type. This is acceptable in mocks.
The `getMarkdownFiles` method correctly types `folder.children as TFile[]` because `createMockMarkdownFiles` (via `createMockTFolder` and `createMockTFiles`) populates children with `TFile` instances.
The static method `recurseChildren` is present; its utility in a mock is specific to how tests might use it, but it's syntactically correct.

No immediate changes seem necessary for type conformance.

Next, I will look at `apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts`.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts

---

Your Grace,

The file `apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts` is structured differently. It uses `vi.mock('obsidian', ...)` to provide mock implementations for several classes from the 'obsidian' module itself (like `WorkspaceItem`, `WorkspaceSidedock`, `WorkspaceRoot`, `WorkspaceWindow`, and `WorkspaceDocument`). Then, it exports its own `Workspace` class mock.

Inside the `vi.mock` factory:
-   `WorkspaceItem` seems fine.
-   `WorkspaceSidedock` also seems fine.
-   `WorkspaceDocument` is an empty class extending `WorkspaceItem`. This is a minimal stub. The original `WorkspaceDocumentType` isn't explicitly imported or implemented, so its completeness depends on what `WorkspaceItemType` covers from `WorkspaceDocumentType`.
-   `WorkspaceWindow`:
    -   `win: Window = vi.fn()` is incorrect. `vi.fn()` creates a mock function, but `win` should be a `Window` object. It should probably be initialized to a mock `Window` or `null/undefined` if the type allows. Given it's typed as `Window`, it needs to be an object matching that interface.
    -   `doc: Document = vi.fn()` is also incorrect. `doc` should be a `Document` object (from `@magus-mark/core/models/Document` as per the import, or `globalThis.Document` if it's the DOM Document). It's assigned a mock function.
-   `WorkspaceRoot`:
    -   `getLeaf: () => WorkspaceLeaf = vi.fn()` is okay for a mock function.
    -   `win: WorkspaceWindow = vi.fn()` is incorrect. `win` should be an instance of `WorkspaceWindow` (the mocked one in this scope), not a mock function.
    -   `doc: WorkspaceDocument = vi.fn()` is incorrect. `doc` should be an instance of `WorkspaceDocument` (the mocked one), not a mock function.
-   The returned object from `vi.mock` correctly provides mock implementations for `WorkspaceSidedock` and `WorkspaceRoot`.
-   The exported `Workspace` class seems to mock a few top-level properties of the main `WorkspaceType` and appears okay for a minimal stub.

The primary issues are the incorrect assignments of `vi.fn()` to properties expecting object instances within the `vi.mock` factory for `WorkspaceWindow` and `WorkspaceRoot`.

I will prepare an edit to address these issues by attempting to instantiate the mocked classes or using a simpler mock object.

---

```diff
    class WorkspaceDocument extends WorkspaceItem implements WorkspaceDocumentType {}
    class WorkspaceWindow extends Events implements WorkspaceWindowType {
-     win: Window = vi.fn();
-     doc: Document = vi.fn();
+     win = {} as Window;
+     doc = {} as Document;
    }
    class WorkspaceRoot extends WorkspaceItem implements WorkspaceRootType {
      getLeaf: () => WorkspaceLeaf = vi.fn();
-     win: WorkspaceWindow = vi.fn();
-     doc: WorkspaceDocument = vi.fn();
+     win: WorkspaceWindow = new WorkspaceWindow();
+     doc: WorkspaceDocument = new WorkspaceDocument({} as WorkspaceParent);
    }
  
```

---

Your Grace,

The corrections have been applied to `apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts`. The `win` and `doc` properties in the mocked `WorkspaceWindow` and `WorkspaceRoot` classes are now assigned more appropriate mock objects or instances instead of `vi.fn()`.

I shall now examine the last file in this directory: `apps/obsidian-plugin/src/__mocks__/obsidian/WorkspaceLeaf.ts`.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/WorkspaceLeaf.ts

---

My Liege,

In `apps/obsidian-plugin/src/__mocks__/obsidian/WorkspaceLeaf.ts`:
The class `WorkspaceLeaf` implements `WorkspaceLeafType`.
Its `constructor` correctly instantiates `this.view = new ItemView(this);`.
The `parent` property is typed as `WorkspaceTabs | WorkspaceMobileDrawer` and initialized with `new WorkspaceTabs()`. This assumes `WorkspaceTabs` is a class that can be instantiated. If `WorkspaceTabs` is an interface or a more complex type from `obsidian.d.ts` that isn't simply constructible, this could be an issue. However, `WorkspaceTabs` is imported directly from `obsidian`, implying it's an exported construct.

The `getRoot()` method returns a an object literal:
```typescript
    return {
      win: {},
      doc: {},
      parent: {},
      getRoot: () => {},
    };
```
This object is meant to satisfy the `WorkspaceRoot` type.
- `win: {}` should be a `WorkspaceWindow`. An empty object `{}` is unlikely to satisfy this.
- `doc: {}` should be a `WorkspaceDocument`. An empty object `{}` is unlikely to satisfy this.
- `parent: {}` should be a `WorkspaceParent`. An empty object `{}` is unlikely to satisfy this.
- `getRoot: () => {}` should be `() => WorkspaceRoot`. A function returning `void` (implicitly) doesn't match.

This return object needs to be a proper mock of `WorkspaceRoot`. Given the changes we made in `Workspace.ts` where we mocked `WorkspaceRoot`, `WorkspaceWindow`, and `WorkspaceDocument`, we could potentially use those, but that might create circular dependencies or overly complex mocks if `Workspace.ts` itself imports `WorkspaceLeaf`. A simpler approach is to ensure the returned object from `getRoot()` at least has the correct shapes for its properties, even if they are minimal stubs.

I will adjust the `getRoot()` method to return a more type-compliant (though still minimal) mock for `WorkspaceRoot`.

---

```diff
    getRoot(): WorkspaceRoot {
      return {
-       win: {},
-       doc: {},
-       parent: {},
-       getRoot: () => {},
-     };
+       win: {} as any,
+       doc: {} as any,
+       parent: {} as any,
+       getLeaf: () => this,
+       getRoot: () => ({} as WorkspaceRoot),
+       getContainer: () => ({} as WorkspaceContainer),
+     } as WorkspaceRoot;
    }
    getContainer(): WorkspaceContainer {
```

---

Your Grace,

The `getRoot()` method in `apps/obsidian-plugin/src/__mocks__/obsidian/WorkspaceLeaf.ts` has been updated to return a more structurally representative mock for `WorkspaceRoot`.

This completes the review of the files directly within the `apps/obsidian-plugin/src/__mocks__/obsidian/` directory. There is also the top-level `apps/obsidian-plugin/src/__mocks__/obsidian.ts` file which re-exports some of these mocks and provides a mock `App`.

Shall I proceed to inspect `apps/obsidian-plugin/src/__mocks__/obsidian.ts`?

Your Humble Servant, Sebastien.

---

_**User**_

[{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/WorkspaceLeaf.ts",
	"owner": "typescript",
	"code": "2322",
	"severity": 8,
	"message": "Type 'ItemView' is not assignable to type 'View'.\n  Types of property 'scope' are incompatible.\n    Type 'unknown' is not assignable to type 'Scope | null'.",
	"source": "ts",
	"startLineNumber": 29,
	"startColumn": 5,
	"endLineNumber": 29,
	"endColumn": 14,
	"modelVersionId": 4
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/WorkspaceLeaf.ts",
	"owner": "typescript",
	"code": "2352",
	"severity": 8,
	"message": "Conversion of type '{ win: any; doc: any; parent: any; getLeaf: () => this; getRoot: () => WorkspaceRoot; getContainer: () => WorkspaceContainer; }' to type 'WorkspaceRoot' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.\n  Type '{ win: any; doc: any; parent: any; getLeaf: () => this; getRoot: () => WorkspaceRoot; getContainer: () => WorkspaceContainer; }' is missing the following properties from type 'WorkspaceRoot': on, off, offref, trigger, tryTrigger",
	"source": "ts",
	"startLineNumber": 37,
	"startColumn": 12,
	"endLineNumber": 44,
	"endColumn": 23,
	"modelVersionId": 4
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/WorkspaceLeaf.ts",
	"owner": "typescript",
	"code": "2739",
	"severity": 8,
	"message": "Type 'HTMLDivElement & ObsidianElementExtras' is missing the following properties from type 'WorkspaceContainer': parent, getRoot, getContainer, offref, tryTrigger",
	"source": "ts",
	"startLineNumber": 47,
	"startColumn": 5,
	"endLineNumber": 47,
	"endColumn": 11,
	"modelVersionId": 4
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2552",
	"severity": 8,
	"message": "Cannot find name 'WorkspaceDocumentType'. Did you mean 'WorkspaceDocument'?",
	"source": "ts",
	"startLineNumber": 40,
	"startColumn": 60,
	"endLineNumber": 40,
	"endColumn": 81,
	"relatedInformation": [
		{
			"startLineNumber": 40,
			"startColumn": 9,
			"endLineNumber": 40,
			"endColumn": 26,
			"message": "'WorkspaceDocument' is declared here.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 3
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'doc' in type 'WorkspaceWindow' is not assignable to the same property in base type 'WorkspaceWindow'.\n  Type 'Document' is missing the following properties from type 'Document': URL, alinkColor, all, anchors, and 273 more.",
	"source": "ts",
	"startLineNumber": 43,
	"startColumn": 5,
	"endLineNumber": 43,
	"endColumn": 8,
	"modelVersionId": 3
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'win' in type 'WorkspaceRoot' is not assignable to the same property in base type 'WorkspaceRoot'.\n  Type 'WorkspaceWindow' is missing the following properties from type 'Window': clientInformation, closed, customElements, devicePixelRatio, and 209 more.",
	"source": "ts",
	"startLineNumber": 47,
	"startColumn": 5,
	"endLineNumber": 47,
	"endColumn": 8,
	"modelVersionId": 3
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'doc' in type 'WorkspaceRoot' is not assignable to the same property in base type 'WorkspaceRoot'.\n  Type 'WorkspaceItem' is missing the following properties from type 'Document': URL, alinkColor, all, anchors, and 271 more.",
	"source": "ts",
	"startLineNumber": 48,
	"startColumn": 5,
	"endLineNumber": 48,
	"endColumn": 8,
	"modelVersionId": 3
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2511",
	"severity": 8,
	"message": "Cannot create an instance of an abstract class.",
	"source": "ts",
	"startLineNumber": 56,
	"startColumn": 32,
	"endLineNumber": 56,
	"endColumn": 53,
	"modelVersionId": 3
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "1361",
	"severity": 8,
	"message": "'WorkspaceParent' cannot be used as a value because it was imported using 'import type'.",
	"source": "ts",
	"startLineNumber": 56,
	"startColumn": 36,
	"endLineNumber": 56,
	"endColumn": 51,
	"relatedInformation": [
		{
			"startLineNumber": 11,
			"startColumn": 3,
			"endLineNumber": 11,
			"endColumn": 18,
			"message": "'WorkspaceParent' was imported here.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 3
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2720",
	"severity": 8,
	"message": "Class 'import(\"/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace\").Workspace' incorrectly implements class 'import(\"/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/node_modules/.pnpm/obsidian@1.8.7_@codemirror+state@6.5.2_@codemirror+view@6.36.8/node_modules/obsidian/obsidian\").Workspace'. Did you mean to extend 'import(\"/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/node_modules/.pnpm/obsidian@1.8.7_@codemirror+state@6.5.2_@codemirror+view@6.36.8/node_modules/obsidian/obsidian\").Workspace' and inherit its members as a subclass?\n  Type 'Workspace' is missing the following properties from type 'Workspace': leftSplit, rightSplit, leftRibbon, rightRibbon, and 30 more.",
	"source": "ts",
	"startLineNumber": 60,
	"startColumn": 14,
	"endLineNumber": 60,
	"endColumn": 23,
	"modelVersionId": 3
}]

you did better but still broken

---

_**Assistant**_



---

Your Grace, it appears we have stirred the nest of types, and they are buzzing quite angrily! Fear not, we shall calm them with careful adjustments. The linter has provided a wealth of information, highlighting several discrepancies between our mocks and the true types they aim to replicate.

I will address these methodically, starting with the errors in `apps/obsidian-plugin/src/__mocks__/obsidian/ItemView.ts` as its `scope` property is causing issues in `WorkspaceLeaf.ts`.

The error is: `Type 'ItemView' is not assignable to type 'View'. Types of property 'scope' are incompatible. Type 'unknown' is not assignable to type 'Scope | null'.`
This indicates that `ItemView.scope`, which is currently `unknown`, needs to be `ScopeType | null`. I'll need to import `Scope as ScopeType` if it's not already, and adjust the type.

First, I will read the `ItemView.ts` file to make the change.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/ItemView.ts

---

Indeed, the `scope` property in `ItemView.ts` is `unknown`. I will change this to `ScopeType | null` and add the necessary import for `Scope as ScopeType` from `obsidian`.

---

```diff
  import { Events } from './MockEvents';
  
- import type { App } from '../obsidian';
+ import type { App, Scope as ScopeType } from '../obsidian';
  import type { MockObsidianElement } from './MockObsidianElement';
  import type { WorkspaceLeaf } from './WorkspaceLeaf';
```

```diff
    leaf: WorkspaceLeaf;
    containerEl: MockObsidianElement<'div'>;
-   scope: unknown = null;
+   scope: ScopeType | null = null;
  
    constructor(leaf: WorkspaceLeaf) {
```

---

Your Grace, the `scope` property in `ItemView.ts` has been adjusted. This should resolve the first error in `WorkspaceLeaf.ts`.

Now, let's address the errors in `apps/obsidian-plugin/src/__mocks__/obsidian/WorkspaceLeaf.ts`:

1.  **`getRoot()` return type**: The error `Conversion of type '{...}' to type 'WorkspaceRoot' may be a mistake... missing properties from type 'WorkspaceRoot': on, off, offref, trigger, tryTrigger` clearly indicates that the returned object needs to include the event methods from `Events`, as `WorkspaceRoot` (like most Obsidian components) extends `Events`.
2.  **`getContainer()` return type**: The error `Type 'HTMLDivElement & ObsidianElementExtras' is missing the following properties from type 'WorkspaceContainer': parent, getRoot, getContainer, offref, tryTrigger` means that `this.containerEl` (which is a `MockObsidianElement<'div'>`) is not a valid `WorkspaceContainer`. A `WorkspaceContainer` is a `WorkspaceItem`, which in turn is an `Events` emitter.

I'll modify `WorkspaceLeaf.ts` to address these. For `getRoot()`, I will add mock event methods to the returned object. For `getContainer()`, this is trickier. The `containerEl` is an actual HTML element mock. Making it a full `WorkspaceContainer` mock might be too much. A common pattern is that `getContainer()` would return `this` if the leaf itself is the container, or a dedicated container property. Given the error, `this.containerEl` is insufficient. I will create a minimal mock for `WorkspaceContainer` within the `WorkspaceLeaf` and return that.

Let's apply these changes.

---

```diff
  
  import type {
+   EventRef,
    Vault as VaultType,
    View,
-   WorkspaceContainer,
+   WorkspaceContainer as WorkspaceContainerType,
+   WorkspaceItem,
    WorkspaceLeaf as WorkspaceLeafType,
    WorkspaceMobileDrawer,
    WorkspaceRoot,
+   WorkspaceParent,
  } from 'obsidian';
  
```

```diff
    app: { vault: VaultType } = { vault: new Vault() }; // Basic app stub
    containerEl: MockObsidianElement<'div'> = createMockObsidianElement<'div'>('div'); // Use helper
+ 
+   // Minimal mock for WorkspaceContainer
+   private _mockContainer: WorkspaceContainerType;
+ 
    constructor() {
      super();
      this.view = new ItemView(this);
      this.containerEl.appendChild(createMockObsidianElement<'div'>('div'));
      this.containerEl.appendChild(createMockObsidianElement<'div'>('div'));
+ 
+     // Initialize mock container
+     this._mockContainer = {
+       ...new Events(), // Spread event methods
+       parent: {} as WorkspaceParent, // Mock parent
+       getRoot: () => this.getRoot(),
+       getContainer: () => this._mockContainer, // Return itself
+       doc: document, // WorkspaceItem property
+       win: window, // WorkspaceItem property
+       // Add other WorkspaceItem/WorkspaceContainer properties if needed
+     } as WorkspaceContainerType;
    }
    setViewState(): Promise<void> {
      return Promise.resolve();
    }
    getRoot(): WorkspaceRoot {
-     return {
-       win: {} as any,
-       doc: {} as any,
-       parent: {} as any,
+     const mockRoot = {
+       ...new Events(), // Spread event methods
+       win: window as any, // Cast to any for simplicity, or use a proper Window mock
+       doc: document as any, // Cast to any for simplicity, or use a proper Document mock
+       parent: {} as any, // Mock WorkspaceParent
        getLeaf: () => this,
-       getRoot: () => ({}) as WorkspaceRoot,
-       getContainer: () => ({}) as WorkspaceContainer,
-     } as WorkspaceRoot;
+       getContainer: () => this._mockContainer, // Use the leaf's mock container
+       // WorkspaceItem properties
+       // getRoot: () => mockRoot, // This creates a problem with mockRoot not being defined yet. A bit tricky.
+       // For simplicity, we'll assume the actual getRoot might come from a more concrete implementation or be less strictly checked in tests.
+       // Casting the whole object to WorkspaceRoot implies these are fulfilled by the actual type.
+     };
+     // A simple way to handle getRoot for a mock is to have it return itself, but care is needed with initialization order.
+     // A common pattern in deep mocks isn't straightforward here. The cast below is a pragmatic choice for mocks.
+     (mockRoot as any).getRoot = () => mockRoot as WorkspaceRoot;
+     return mockRoot as WorkspaceRoot;
    }
-   getContainer(): WorkspaceContainer {
-     return this.containerEl;
+   getContainer(): WorkspaceContainerType {
+     return this._mockContainer;
    }
    getEphemeralState(): Record<string, unknown> {
```

---

Your Grace, the modifications to `WorkspaceLeaf.ts` have been applied. I've added event methods to the `getRoot()`'s return object and created a more compliant mock for `WorkspaceContainerType` to be returned by `getContainer()`.

Now, I shall turn my attention to the errors in `apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts`.

1.  **`Cannot find name 'WorkspaceDocumentType'`**: This is a typo. It should be `WorkspaceDocument`.
2.  **`Property 'doc' in type 'WorkspaceWindow' is not assignable...`**: The mock `WorkspaceWindow.doc` is `{} as Document` (from `@magus-mark/core`). The base type expects a DOM `Document`. I'll change this to `document as Document` (which refers to the global DOM `document`).
3.  **`Property 'win' in type 'WorkspaceRoot' is not assignable...`**: The mock `WorkspaceRoot.win` is `new WorkspaceWindow()`. The error means this mock `WorkspaceWindow` is missing properties of the global `Window`. The mock `WorkspaceWindow`'s `win` property (which is `{} as Window`) needs to be a more complete mock of `globalThis.Window`. For simplicity in the mock, I'll cast `window as any` or a more specific mock if needed, but often a simple cast is sufficient for mocks not exercising deep `Window` properties. I'll ensure `MockWorkspaceWindow.win` itself is `window as Window`.
4.  **`Property 'doc' in type 'WorkspaceRoot' is not assignable...`**: Similar to point 2, `WorkspaceRoot.doc` (currently `new WorkspaceDocument(...)`) is expected to be a DOM `Document`. The mock `WorkspaceDocument` needs its `doc` property (if it had one, or if `WorkspaceItem` is assumed to be a DOM element-like thing) to align, or `WorkspaceRoot.doc` should be directly assigned `document as Document`.
5.  **`Cannot create an instance of an abstract class.` (for `WorkspaceParent`) and `'WorkspaceParent' cannot be used as a value...`**: `WorkspaceParent` is type-only. I'll replace `new WorkspaceParent()` with a simple object literal mock `{}` cast to `WorkspaceParent`.
6.  **`Class 'Workspace' incorrectly implements... missing ... properties`**: The exported `Workspace` mock class needs to have all properties from `WorkspaceType` defined, even if just as `vi.fn()` or default values.

I will now apply these corrections to `Workspace.ts`.

---

```diff
  import { Events } from './MockEvents';
  
- import type { Document } from '@magus-mark/core/models/Document';
  import type {
+   App,
+   Keymap,
    MarkdownFileInfo,
+   MarkdownView,
+   Plugin,
+   View,
    WorkspaceContainer,
    WorkspaceItem as WorkspaceItemType,
-   WorkspaceParent,
    WorkspaceRoot as WorkspaceRootType,
    WorkspaceSidedock as WorkspaceSidedockType,
-   Workspace as WorkspaceType,
+   WorkspaceSplit,
+   WorkspaceTabs,
    WorkspaceWindow as WorkspaceWindowType,
+   Workspace as WorkspaceType,
+   LayoutRect,
+   RibbonBar,
+   StatusBar,
  } from 'obsidian';
  
  import type { MockObsidianElement } from './MockObsidianElement';
  import type { WorkspaceLeaf } from './WorkspaceLeaf';
+ 
+ interface MockWorkspaceParent extends WorkspaceItemType { /* add specific parent props if any */ }
  
  vi.mock('obsidian', () => {
    class WorkspaceItem extends Events implements WorkspaceItemType {
-     getRoot: () => WorkspaceRoot = vi.fn();
+     getRoot: () => WorkspaceRootType = vi.fn();
      getContainer: () => WorkspaceContainer = vi.fn();
-     parent: WorkspaceParent;
-     constructor(parent: WorkspaceParent) {
+     parent: MockWorkspaceParent;
+     constructor(parent: MockWorkspaceParent) {
        super();
        this.parent = parent;
```

```diff
    class WorkspaceSidedock extends WorkspaceItem implements WorkspaceSidedockType {
      collapsed = false;
-     // WorkspaceSidedock
      toggle: () => void = vi.fn();
      collapse: () => void = vi.fn();
      expand: () => void = vi.fn();
+     constructor(parent: MockWorkspaceParent) {
+       super(parent);
+     }
    }
  
-   class WorkspaceDocument extends WorkspaceItem implements WorkspaceDocumentType {}
-   class WorkspaceWindow extends Events implements WorkspaceWindowType {
-     win = {} as Window;
-     doc = {} as Document;
-   }
-   class WorkspaceRoot extends WorkspaceItem implements WorkspaceRootType {
-     getLeaf: () => WorkspaceLeaf = vi.fn();
-     win: WorkspaceWindow = new WorkspaceWindow();
-     doc: WorkspaceDocument = new WorkspaceDocument({} as WorkspaceParent);
-   }
+   class WorkspaceDocumentMock extends WorkspaceItem { /* implements WorkspaceDocumentType if it existed and was distinct */ }
+ 
+   class WorkspaceWindowMock extends Events implements WorkspaceWindowType {
+     win: Window = window as Window;
+     doc: Document = document as Document;
+     app: App = {} as App;
+     constructor() {
+       super();
+     }
+     activeLeaf: WorkspaceLeaf | undefined = undefined;
+     leftSplit: WorkspaceSplit = {} as WorkspaceSplit;
+     rightSplit: WorkspaceSplit = {} as WorkspaceSplit;
+     getLeafById: (id: string) => WorkspaceLeaf = vi.fn();
+     getLeavesOfType: (type: string) => WorkspaceLeaf[] = vi.fn();
+     getLeftLeaf: (sticky?: boolean) => WorkspaceLeaf = vi.fn();
+     getRightLeaf: (sticky?: boolean) => WorkspaceLeaf = vi.fn();
+     createLeafInParent: (parent: WorkspaceSplit, index?: number) => WorkspaceLeaf = vi.fn();
+     splitActiveLeaf: (direction?: 'vertical' | 'horizontal') => WorkspaceLeaf = vi.fn();
+     rootSplit: WorkspaceSplit = {} as WorkspaceSplit;
+     activeTabGroup: WorkspaceTabs | null = null;
+   }
+ 
+   class WorkspaceRootMock extends WorkspaceItem implements WorkspaceRootType {
+     getLeaf: (newLeaf?: boolean) => WorkspaceLeaf = vi.fn();
+     win: WorkspaceWindowMock = new WorkspaceWindowMock();
+     doc: Document = document as Document;
+     constructor(parent: MockWorkspaceParent) {
+       super(parent);
+     }
+     activeEditor: MarkdownFileInfo | null = null;
+     activeLeaf: WorkspaceLeaf | null = null;
+     getUnpinnedLeaves: (type?: string) => WorkspaceLeaf[] = vi.fn();
+   }
+ 
+   const mockParent = {} as MockWorkspaceParent;
  
    return {
-     WorkspaceSidedock: vi.fn().mockImplementation((parent: WorkspaceParent) => {
-       return new WorkspaceSidedock(parent);
-     }),
-     WorkspaceRoot: vi.fn().mockImplementation(() => {
-       return new WorkspaceRoot(new WorkspaceParent());
-     }),
+     WorkspaceSidedock: vi.fn().mockImplementation(() => new WorkspaceSidedock(mockParent)),
+     WorkspaceRoot: vi.fn().mockImplementation(() => new WorkspaceRootMock(mockParent)),
    };
  });
+ 
  export class Workspace extends Events implements WorkspaceType {
    activeLeaf: WorkspaceLeaf | null = null;
    containerEl: MockObsidianElement = createMockObsidianElement('div');
    layoutReady = true;
    activeEditor: MarkdownFileInfo | null = null;
+ 
+   leftSplit: WorkspaceSplit = {} as WorkspaceSplit;
+   rightSplit: WorkspaceSplit = {} as WorkspaceSplit;
+   leftRibbon: RibbonBar = {} as RibbonBar;
+   rightRibbon: RibbonBar = {} as RibbonBar;
+   headerInfoEl: HTMLElement = document.createElement('div');
+   statusBar: StatusBar = {} as StatusBar;
+   floatingSplit: WorkspaceSplit | null = null;
+   rootSplit: WorkspaceRootType = {} as WorkspaceRootType;
+   activeTabGroup: WorkspaceTabs | null = null;
+   requestSaveLayout = vi.fn<() => void>();
+   onLayoutReady = vi.fn<(callback: () => any) => void>();
+   getLayout = vi.fn<() => any>();
+   setLayout = vi.fn<(layout: any) => Promise<void>>();
+   openPopoutLeaf = vi.fn<() => WorkspaceLeaf>();
+   openPopout = vi.fn<() => Promise<WorkspaceWindowType>>();
+   openWindow = vi.fn<() => Promise<WorkspaceWindowType>>();
+   getLeaf = vi.fn<(newLeaf?: boolean | 'split' | 'tab' | 'window') => WorkspaceLeaf>();
+   getLeftLeaf = vi.fn<(sticky?: boolean) => WorkspaceLeaf>();
+   getRightLeaf = vi.fn<(sticky?: boolean) => WorkspaceLeaf>();
+   getUnpinnedLeaves = vi.fn<(type?: string) => WorkspaceLeaf[]>();
+   getLeafById = vi.fn<(id: string) => WorkspaceLeaf>();
+   getLeavesOfType = vi.fn<(viewType: string) => WorkspaceLeaf[]>();
+   getMostRecentLeaf = vi.fn<(root?: WorkspaceRootType | WorkspaceItemType) => WorkspaceLeaf | null>();
+   createLeafBySplit = vi.fn<(split: WorkspaceSplit, viewType?: string, options?: any) => WorkspaceLeaf>();
+   createLeafInParent = vi.fn<(parentSplit: WorkspaceSplit, index?: number) => WorkspaceLeaf>();
+   createLeafInTabGroup = vi.fn<(group: WorkspaceTabs, index?: number) => WorkspaceLeaf>();
+   splitActiveLeaf = vi.fn<(direction?: 'vertical' | 'horizontal', before?: boolean) => WorkspaceLeaf>();
+   setActiveLeaf = vi.fn<(leaf: WorkspaceLeaf, params?: { focus?: boolean }) => void>();
+   openLinkText = vi.fn<(linktext: string, sourcePath: string, newLeaf?: boolean | PaneType, openViewState?: OpenViewState) => Promise<void>>();
+   openFile = vi.fn<(file: View['file'], openViewState?: OpenViewState) => Promise<void>>();
+   getDropLocation = vi.fn<(event: DragEvent) => { target: WorkspaceItemType | null, aSide: 'left' | 'right' | 'top' | 'bottom' | null, bSide: 'v' | 'h' | null }>();
+   iterateRootLeaves = vi.fn<(callback: (leaf: WorkspaceLeaf) => any) => void>();
+   iterateAllLeaves = vi.fn<(callback: (leaf: WorkspaceLeaf) => any) => void>();
+   getAdjacentLeaf = vi.fn<(leaf: WorkspaceLeaf, direction: 'top' | 'bottom' | 'left' | 'right') => WorkspaceLeaf | null>();
+   getActiveViewOfType = vi.fn<<T extends View>(type: new (...args: any[]) => T) => T | null>();
+   getActiveFile = vi.fn<() => View['file'] | null>();
+   updateOptions = vi.fn<() => void>();
+   on = vi.fn<any>();
+   off = vi.fn<any>();
+   offref = vi.fn<any>();
+   trigger = vi.fn<any>();
+   tryTrigger = vi.fn<any>();
+ 
+   constructor() {
+     super();
+   }
+ 
+   onFileOpen: EventRef = {} as EventRef;
+   onLayoutChange: EventRef = {} as EventRef;
+   onActiveLeafChange: EventRef = {} as EventRef;
+   createLeafInNewWindow = vi.fn<(viewType?: string, options?: any) => WorkspaceLeaf>();
+   duplicateLeaf = vi.fn<(leaf: WorkspaceLeaf, viewType?: string, options?: any) => WorkspaceLeaf>();
+   detachLeavesOfType = vi.fn<(viewType: string) => void>();
+   revealLeaf = vi.fn<(leaf: WorkspaceLeaf) => void>();
+   getLastOpenFiles = vi.fn<() => string[]>();
+   addToSameGroup = vi.fn<(leaf: WorkspaceLeaf, target: WorkspaceLeaf) => void>();
+   closePopout = vi.fn<() => Promise<void>>();
+   moveLeafToPopout = vi.fn<(leaf: WorkspaceLeaf, dimensions?: LayoutRect) => WorkspaceWindowType>();
+   openParentLeaf = vi.fn<(leaf: WorkspaceLeaf) => WorkspaceLeaf | null>();
+ }
+ 
+ type PaneType = boolean | 'split' | 'tab' | 'window';
+ interface OpenViewState {
+   active?: boolean;
+   eState?: any;
+   state?: any;
+   type?: string;
  }
  
```

---

Your Grace, the extensive changes to `apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts` have been applied. This involved correcting internal mock classes, type usages, and significantly fleshing out the exported `Workspace` mock to include many missing properties from `WorkspaceType`.

We have now addressed the errors in both `WorkspaceLeaf.ts` and `Workspace.ts` based on the last set of linter messages.

There is still the top-level `apps/obsidian-plugin/src/__mocks__/obsidian.ts` file. Shall I proceed to inspect and, if necessary, correct this file as well?

Your Humble Servant, Sebastien.

---

_**User**_

You just destroyed my world bro. Fix all these until it's fucking fixed bro.

[{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/ItemView.ts",
	"owner": "typescript",
	"code": "2305",
	"severity": 8,
	"message": "Module '\"../obsidian\"' has no exported member 'Scope'.",
	"source": "ts",
	"startLineNumber": 4,
	"startColumn": 20,
	"endLineNumber": 4,
	"endColumn": 25,
	"modelVersionId": 10
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2305",
	"severity": 8,
	"message": "Module '\"obsidian\"' has no exported member 'LayoutRect'.",
	"source": "ts",
	"startLineNumber": 10,
	"startColumn": 3,
	"endLineNumber": 10,
	"endColumn": 13,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2305",
	"severity": 8,
	"message": "Module '\"obsidian\"' has no exported member 'RibbonBar'.",
	"source": "ts",
	"startLineNumber": 14,
	"startColumn": 3,
	"endLineNumber": 14,
	"endColumn": 12,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2305",
	"severity": 8,
	"message": "Module '\"obsidian\"' has no exported member 'StatusBar'.",
	"source": "ts",
	"startLineNumber": 15,
	"startColumn": 3,
	"endLineNumber": 15,
	"endColumn": 12,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2720",
	"severity": 8,
	"message": "Class 'WorkspaceWindowMock' incorrectly implements class 'WorkspaceWindow'. Did you mean to extend 'WorkspaceWindow' and inherit its members as a subclass?\n  Type 'WorkspaceWindowMock' is missing the following properties from type 'WorkspaceWindow': parent, getRoot, getContainer",
	"source": "ts",
	"startLineNumber": 59,
	"startColumn": 9,
	"endLineNumber": 59,
	"endColumn": 28,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'win' in type 'WorkspaceRootMock' is not assignable to the same property in base type 'WorkspaceRoot'.\n  Type 'WorkspaceWindowMock' is missing the following properties from type 'Window': clientInformation, closed, customElements, devicePixelRatio, and 209 more.",
	"source": "ts",
	"startLineNumber": 81,
	"startColumn": 5,
	"endLineNumber": 81,
	"endColumn": 8,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'leftSplit' in type 'Workspace' is not assignable to the same property in base type 'Workspace'.\n  Type 'WorkspaceSplit' is not assignable to type 'WorkspaceMobileDrawer | WorkspaceSidedock'.\n    Type 'WorkspaceSplit' is missing the following properties from type 'WorkspaceSidedock': collapsed, toggle, collapse, expand",
	"source": "ts",
	"startLineNumber": 105,
	"startColumn": 3,
	"endLineNumber": 105,
	"endColumn": 12,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'rightSplit' in type 'Workspace' is not assignable to the same property in base type 'Workspace'.\n  Type 'WorkspaceSplit' is not assignable to type 'WorkspaceMobileDrawer | WorkspaceSidedock'.\n    Type 'WorkspaceSplit' is missing the following properties from type 'WorkspaceSidedock': collapsed, toggle, collapse, expand",
	"source": "ts",
	"startLineNumber": 106,
	"startColumn": 3,
	"endLineNumber": 106,
	"endColumn": 13,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'requestSaveLayout' in type 'Workspace' is not assignable to the same property in base type 'Workspace'.\n  Type 'Mock<() => void>' is missing the following properties from type 'Debouncer<[], Promise<void>>': cancel, run",
	"source": "ts",
	"startLineNumber": 114,
	"startColumn": 3,
	"endLineNumber": 114,
	"endColumn": 20,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 114,
	"startColumn": 3,
	"endLineNumber": 114,
	"endColumn": 20,
	"relatedInformation": [
		{
			"startLineNumber": 114,
			"startColumn": 3,
			"endLineNumber": 114,
			"endColumn": 20,
			"message": "Add a type annotation to the property requestSaveLayout.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 115,
	"startColumn": 3,
	"endLineNumber": 115,
	"endColumn": 16,
	"relatedInformation": [
		{
			"startLineNumber": 115,
			"startColumn": 3,
			"endLineNumber": 115,
			"endColumn": 16,
			"message": "Add a type annotation to the property onLayoutReady.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 116,
	"startColumn": 3,
	"endLineNumber": 116,
	"endColumn": 12,
	"relatedInformation": [
		{
			"startLineNumber": 116,
			"startColumn": 3,
			"endLineNumber": 116,
			"endColumn": 12,
			"message": "Add a type annotation to the property getLayout.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 117,
	"startColumn": 3,
	"endLineNumber": 117,
	"endColumn": 12,
	"relatedInformation": [
		{
			"startLineNumber": 117,
			"startColumn": 3,
			"endLineNumber": 117,
			"endColumn": 12,
			"message": "Add a type annotation to the property setLayout.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 118,
	"startColumn": 3,
	"endLineNumber": 118,
	"endColumn": 17,
	"relatedInformation": [
		{
			"startLineNumber": 118,
			"startColumn": 3,
			"endLineNumber": 118,
			"endColumn": 17,
			"message": "Add a type annotation to the property openPopoutLeaf.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 119,
	"startColumn": 3,
	"endLineNumber": 119,
	"endColumn": 13,
	"relatedInformation": [
		{
			"startLineNumber": 119,
			"startColumn": 3,
			"endLineNumber": 119,
			"endColumn": 13,
			"message": "Add a type annotation to the property openPopout.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 120,
	"startColumn": 3,
	"endLineNumber": 120,
	"endColumn": 13,
	"relatedInformation": [
		{
			"startLineNumber": 120,
			"startColumn": 3,
			"endLineNumber": 120,
			"endColumn": 13,
			"message": "Add a type annotation to the property openWindow.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 121,
	"startColumn": 3,
	"endLineNumber": 121,
	"endColumn": 10,
	"relatedInformation": [
		{
			"startLineNumber": 121,
			"startColumn": 3,
			"endLineNumber": 121,
			"endColumn": 10,
			"message": "Add a type annotation to the property getLeaf.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 122,
	"startColumn": 3,
	"endLineNumber": 122,
	"endColumn": 14,
	"relatedInformation": [
		{
			"startLineNumber": 122,
			"startColumn": 3,
			"endLineNumber": 122,
			"endColumn": 14,
			"message": "Add a type annotation to the property getLeftLeaf.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 123,
	"startColumn": 3,
	"endLineNumber": 123,
	"endColumn": 15,
	"relatedInformation": [
		{
			"startLineNumber": 123,
			"startColumn": 3,
			"endLineNumber": 123,
			"endColumn": 15,
			"message": "Add a type annotation to the property getRightLeaf.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 124,
	"startColumn": 3,
	"endLineNumber": 124,
	"endColumn": 20,
	"relatedInformation": [
		{
			"startLineNumber": 124,
			"startColumn": 3,
			"endLineNumber": 124,
			"endColumn": 20,
			"message": "Add a type annotation to the property getUnpinnedLeaves.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 125,
	"startColumn": 3,
	"endLineNumber": 125,
	"endColumn": 14,
	"relatedInformation": [
		{
			"startLineNumber": 125,
			"startColumn": 3,
			"endLineNumber": 125,
			"endColumn": 14,
			"message": "Add a type annotation to the property getLeafById.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 126,
	"startColumn": 3,
	"endLineNumber": 126,
	"endColumn": 18,
	"relatedInformation": [
		{
			"startLineNumber": 126,
			"startColumn": 3,
			"endLineNumber": 126,
			"endColumn": 18,
			"message": "Add a type annotation to the property getLeavesOfType.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 127,
	"startColumn": 3,
	"endLineNumber": 127,
	"endColumn": 20,
	"relatedInformation": [
		{
			"startLineNumber": 127,
			"startColumn": 3,
			"endLineNumber": 127,
			"endColumn": 20,
			"message": "Add a type annotation to the property getMostRecentLeaf.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 128,
	"startColumn": 3,
	"endLineNumber": 128,
	"endColumn": 20,
	"relatedInformation": [
		{
			"startLineNumber": 128,
			"startColumn": 3,
			"endLineNumber": 128,
			"endColumn": 20,
			"message": "Add a type annotation to the property createLeafBySplit.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 129,
	"startColumn": 3,
	"endLineNumber": 129,
	"endColumn": 21,
	"relatedInformation": [
		{
			"startLineNumber": 129,
			"startColumn": 3,
			"endLineNumber": 129,
			"endColumn": 21,
			"message": "Add a type annotation to the property createLeafInParent.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 130,
	"startColumn": 3,
	"endLineNumber": 130,
	"endColumn": 23,
	"relatedInformation": [
		{
			"startLineNumber": 130,
			"startColumn": 3,
			"endLineNumber": 130,
			"endColumn": 23,
			"message": "Add a type annotation to the property createLeafInTabGroup.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 131,
	"startColumn": 3,
	"endLineNumber": 131,
	"endColumn": 18,
	"relatedInformation": [
		{
			"startLineNumber": 131,
			"startColumn": 3,
			"endLineNumber": 131,
			"endColumn": 18,
			"message": "Add a type annotation to the property splitActiveLeaf.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'setActiveLeaf' in type 'Workspace' is not assignable to the same property in base type 'Workspace'.\n  Type 'Mock<(leaf: WorkspaceLeaf, params?: { focus?: boolean; } | undefined) => void>' is not assignable to type '{ (leaf: WorkspaceLeaf, params?: { focus?: boolean; } | undefined): void; (leaf: WorkspaceLeaf, pushHistory: boolean, focus: boolean): void; }'.\n    Types of parameters 'params' and 'pushHistory' are incompatible.\n      Type 'boolean' has no properties in common with type '{ focus?: boolean; }'.",
	"source": "ts",
	"startLineNumber": 132,
	"startColumn": 3,
	"endLineNumber": 132,
	"endColumn": 16,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 132,
	"startColumn": 3,
	"endLineNumber": 132,
	"endColumn": 16,
	"relatedInformation": [
		{
			"startLineNumber": 132,
			"startColumn": 3,
			"endLineNumber": 132,
			"endColumn": 16,
			"message": "Add a type annotation to the property setActiveLeaf.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 133,
	"startColumn": 3,
	"endLineNumber": 133,
	"endColumn": 15,
	"relatedInformation": [
		{
			"startLineNumber": 133,
			"startColumn": 3,
			"endLineNumber": 133,
			"endColumn": 15,
			"message": "Add a type annotation to the property openLinkText.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 142,
	"startColumn": 3,
	"endLineNumber": 142,
	"endColumn": 11,
	"relatedInformation": [
		{
			"startLineNumber": 142,
			"startColumn": 3,
			"endLineNumber": 142,
			"endColumn": 11,
			"message": "Add a type annotation to the property openFile.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2339",
	"severity": 8,
	"message": "Property 'file' does not exist on type 'View'.",
	"source": "ts",
	"startLineNumber": 142,
	"startColumn": 32,
	"endLineNumber": 142,
	"endColumn": 38,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 143,
	"startColumn": 3,
	"endLineNumber": 143,
	"endColumn": 18,
	"relatedInformation": [
		{
			"startLineNumber": 143,
			"startColumn": 3,
			"endLineNumber": 143,
			"endColumn": 18,
			"message": "Add a type annotation to the property getDropLocation.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 150,
	"startColumn": 3,
	"endLineNumber": 150,
	"endColumn": 20,
	"relatedInformation": [
		{
			"startLineNumber": 150,
			"startColumn": 3,
			"endLineNumber": 150,
			"endColumn": 20,
			"message": "Add a type annotation to the property iterateRootLeaves.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 151,
	"startColumn": 3,
	"endLineNumber": 151,
	"endColumn": 19,
	"relatedInformation": [
		{
			"startLineNumber": 151,
			"startColumn": 3,
			"endLineNumber": 151,
			"endColumn": 19,
			"message": "Add a type annotation to the property iterateAllLeaves.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 152,
	"startColumn": 3,
	"endLineNumber": 152,
	"endColumn": 18,
	"relatedInformation": [
		{
			"startLineNumber": 152,
			"startColumn": 3,
			"endLineNumber": 152,
			"endColumn": 18,
			"message": "Add a type annotation to the property getAdjacentLeaf.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'getActiveViewOfType' in type 'Workspace' is not assignable to the same property in base type 'Workspace'.\n  Type 'Mock<(<T extends View>(type: new (...args: any[]) => T) => T | null)>' is not assignable to type '<T extends View>(type: Constructor<T>) => T | null'.\n    Types of parameters 'type' and 'type' are incompatible.\n      Type 'Constructor<T>' is not assignable to type 'new (...args: any[]) => View'.\n        Cannot assign an abstract constructor type to a non-abstract constructor type.",
	"source": "ts",
	"startLineNumber": 154,
	"startColumn": 3,
	"endLineNumber": 154,
	"endColumn": 22,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 154,
	"startColumn": 3,
	"endLineNumber": 154,
	"endColumn": 22,
	"relatedInformation": [
		{
			"startLineNumber": 154,
			"startColumn": 3,
			"endLineNumber": 154,
			"endColumn": 22,
			"message": "Add a type annotation to the property getActiveViewOfType.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 155,
	"startColumn": 3,
	"endLineNumber": 155,
	"endColumn": 16,
	"relatedInformation": [
		{
			"startLineNumber": 155,
			"startColumn": 3,
			"endLineNumber": 155,
			"endColumn": 16,
			"message": "Add a type annotation to the property getActiveFile.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2339",
	"severity": 8,
	"message": "Property 'file' does not exist on type 'View'.",
	"source": "ts",
	"startLineNumber": 155,
	"startColumn": 36,
	"endLineNumber": 155,
	"endColumn": 42,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 156,
	"startColumn": 3,
	"endLineNumber": 156,
	"endColumn": 16,
	"relatedInformation": [
		{
			"startLineNumber": 156,
			"startColumn": 3,
			"endLineNumber": 156,
			"endColumn": 16,
			"message": "Add a type annotation to the property updateOptions.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "4114",
	"severity": 8,
	"message": "This member must have an 'override' modifier because it overrides a member in the base class 'MockEvents'.",
	"source": "ts",
	"startLineNumber": 157,
	"startColumn": 3,
	"endLineNumber": 157,
	"endColumn": 5,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 157,
	"startColumn": 3,
	"endLineNumber": 157,
	"endColumn": 5,
	"relatedInformation": [
		{
			"startLineNumber": 157,
			"startColumn": 3,
			"endLineNumber": 157,
			"endColumn": 5,
			"message": "Add a type annotation to the property on.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "4114",
	"severity": 8,
	"message": "This member must have an 'override' modifier because it overrides a member in the base class 'MockEvents'.",
	"source": "ts",
	"startLineNumber": 158,
	"startColumn": 3,
	"endLineNumber": 158,
	"endColumn": 6,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 158,
	"startColumn": 3,
	"endLineNumber": 158,
	"endColumn": 6,
	"relatedInformation": [
		{
			"startLineNumber": 158,
			"startColumn": 3,
			"endLineNumber": 158,
			"endColumn": 6,
			"message": "Add a type annotation to the property off.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "4114",
	"severity": 8,
	"message": "This member must have an 'override' modifier because it overrides a member in the base class 'MockEvents'.",
	"source": "ts",
	"startLineNumber": 159,
	"startColumn": 3,
	"endLineNumber": 159,
	"endColumn": 9,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 159,
	"startColumn": 3,
	"endLineNumber": 159,
	"endColumn": 9,
	"relatedInformation": [
		{
			"startLineNumber": 159,
			"startColumn": 3,
			"endLineNumber": 159,
			"endColumn": 9,
			"message": "Add a type annotation to the property offref.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "4114",
	"severity": 8,
	"message": "This member must have an 'override' modifier because it overrides a member in the base class 'MockEvents'.",
	"source": "ts",
	"startLineNumber": 160,
	"startColumn": 3,
	"endLineNumber": 160,
	"endColumn": 10,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 160,
	"startColumn": 3,
	"endLineNumber": 160,
	"endColumn": 10,
	"relatedInformation": [
		{
			"startLineNumber": 160,
			"startColumn": 3,
			"endLineNumber": 160,
			"endColumn": 10,
			"message": "Add a type annotation to the property trigger.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "4114",
	"severity": 8,
	"message": "This member must have an 'override' modifier because it overrides a member in the base class 'MockEvents'.",
	"source": "ts",
	"startLineNumber": 161,
	"startColumn": 3,
	"endLineNumber": 161,
	"endColumn": 13,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 161,
	"startColumn": 3,
	"endLineNumber": 161,
	"endColumn": 13,
	"relatedInformation": [
		{
			"startLineNumber": 161,
			"startColumn": 3,
			"endLineNumber": 161,
			"endColumn": 13,
			"message": "Add a type annotation to the property tryTrigger.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 170,
	"startColumn": 3,
	"endLineNumber": 170,
	"endColumn": 24,
	"relatedInformation": [
		{
			"startLineNumber": 170,
			"startColumn": 3,
			"endLineNumber": 170,
			"endColumn": 24,
			"message": "Add a type annotation to the property createLeafInNewWindow.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'duplicateLeaf' in type 'Workspace' is not assignable to the same property in base type 'Workspace'.\n  Type 'Mock<(leaf: WorkspaceLeaf, viewType?: string | undefined, options?: any) => WorkspaceLeaf>' is not assignable to type '{ (leaf: WorkspaceLeaf, direction?: SplitDirection | undefined): Promise<WorkspaceLeaf>; (leaf: WorkspaceLeaf, leafType: boolean | PaneType, direction?: SplitDirection | undefined): Promise<...>; }'.\n    Type 'WorkspaceLeaf' is missing the following properties from type 'Promise<WorkspaceLeaf>': then, catch, finally, [Symbol.toStringTag]",
	"source": "ts",
	"startLineNumber": 171,
	"startColumn": 3,
	"endLineNumber": 171,
	"endColumn": 16,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 171,
	"startColumn": 3,
	"endLineNumber": 171,
	"endColumn": 16,
	"relatedInformation": [
		{
			"startLineNumber": 171,
			"startColumn": 3,
			"endLineNumber": 171,
			"endColumn": 16,
			"message": "Add a type annotation to the property duplicateLeaf.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 172,
	"startColumn": 3,
	"endLineNumber": 172,
	"endColumn": 21,
	"relatedInformation": [
		{
			"startLineNumber": 172,
			"startColumn": 3,
			"endLineNumber": 172,
			"endColumn": 21,
			"message": "Add a type annotation to the property detachLeavesOfType.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'revealLeaf' in type 'Workspace' is not assignable to the same property in base type 'Workspace'.\n  Type 'Mock<(leaf: WorkspaceLeaf) => void>' is not assignable to type '(leaf: WorkspaceLeaf) => Promise<void>'.\n    Type 'void' is not assignable to type 'Promise<void>'.",
	"source": "ts",
	"startLineNumber": 173,
	"startColumn": 3,
	"endLineNumber": 173,
	"endColumn": 13,
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 173,
	"startColumn": 3,
	"endLineNumber": 173,
	"endColumn": 13,
	"relatedInformation": [
		{
			"startLineNumber": 173,
			"startColumn": 3,
			"endLineNumber": 173,
			"endColumn": 13,
			"message": "Add a type annotation to the property revealLeaf.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 174,
	"startColumn": 3,
	"endLineNumber": 174,
	"endColumn": 19,
	"relatedInformation": [
		{
			"startLineNumber": 174,
			"startColumn": 3,
			"endLineNumber": 174,
			"endColumn": 19,
			"message": "Add a type annotation to the property getLastOpenFiles.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 175,
	"startColumn": 3,
	"endLineNumber": 175,
	"endColumn": 17,
	"relatedInformation": [
		{
			"startLineNumber": 175,
			"startColumn": 3,
			"endLineNumber": 175,
			"endColumn": 17,
			"message": "Add a type annotation to the property addToSameGroup.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 176,
	"startColumn": 3,
	"endLineNumber": 176,
	"endColumn": 14,
	"relatedInformation": [
		{
			"startLineNumber": 176,
			"startColumn": 3,
			"endLineNumber": 176,
			"endColumn": 14,
			"message": "Add a type annotation to the property closePopout.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 177,
	"startColumn": 3,
	"endLineNumber": 177,
	"endColumn": 19,
	"relatedInformation": [
		{
			"startLineNumber": 177,
			"startColumn": 3,
			"endLineNumber": 177,
			"endColumn": 19,
			"message": "Add a type annotation to the property moveLeafToPopout.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "9012",
	"severity": 8,
	"message": "Property must have an explicit type annotation with --isolatedDeclarations.",
	"source": "ts",
	"startLineNumber": 178,
	"startColumn": 3,
	"endLineNumber": 178,
	"endColumn": 17,
	"relatedInformation": [
		{
			"startLineNumber": 178,
			"startColumn": 3,
			"endLineNumber": 178,
			"endColumn": 17,
			"message": "Add a type annotation to the property openParentLeaf.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts"
		}
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "6196",
	"severity": 4,
	"message": "'Keymap' is declared but never used.",
	"source": "ts",
	"startLineNumber": 9,
	"startColumn": 3,
	"endLineNumber": 9,
	"endColumn": 9,
	"tags": [
		1
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "6196",
	"severity": 4,
	"message": "'MarkdownView' is declared but never used.",
	"source": "ts",
	"startLineNumber": 12,
	"startColumn": 3,
	"endLineNumber": 12,
	"endColumn": 15,
	"tags": [
		1
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "6196",
	"severity": 4,
	"message": "'Plugin' is declared but never used.",
	"source": "ts",
	"startLineNumber": 13,
	"startColumn": 3,
	"endLineNumber": 13,
	"endColumn": 9,
	"tags": [
		1
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "6196",
	"severity": 4,
	"message": "'WorkspaceDocumentMock' is declared but never used.",
	"source": "ts",
	"startLineNumber": 55,
	"startColumn": 9,
	"endLineNumber": 55,
	"endColumn": 30,
	"tags": [
		1
	],
	"modelVersionId": 18
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/WorkspaceLeaf.ts",
	"owner": "typescript",
	"code": "2322",
	"severity": 8,
	"message": "Type 'ItemView' is not assignable to type 'View'.\n  Property 'onOpen' is protected but type 'ItemView' is not a class derived from 'View'.",
	"source": "ts",
	"startLineNumber": 36,
	"startColumn": 5,
	"endLineNumber": 36,
	"endColumn": 14,
	"modelVersionId": 7
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/WorkspaceLeaf.ts",
	"owner": "typescript",
	"code": "2352",
	"severity": 8,
	"message": "Conversion of type '{ win: any; doc: any; parent: any; getLeaf: () => this; getContainer: () => WorkspaceContainerType; on: (...args: unknown[]) => EventRef; off: (...args: unknown[]) => void; offref: (...args: unknown[]) => void; trigger: (...args: unknown[]) => void; tryTrigger: (...args: unknown[]) => void; }' to type 'WorkspaceRoot' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.\n  Property 'getRoot' is missing in type '{ win: any; doc: any; parent: any; getLeaf: () => this; getContainer: () => WorkspaceContainerType; on: (...args: unknown[]) => EventRef; off: (...args: unknown[]) => void; offref: (...args: unknown[]) => void; trigger: (...args: unknown[]) => void; tryTrigger: (...args: unknown[]) => void; }' but required in type 'WorkspaceRoot'.",
	"source": "ts",
	"startLineNumber": 69,
	"startColumn": 39,
	"endLineNumber": 69,
	"endColumn": 64,
	"relatedInformation": [
		{
			"startLineNumber": 5078,
			"startColumn": 5,
			"endLineNumber": 5078,
			"endColumn": 12,
			"message": "'getRoot' is declared here.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/node_modules/.pnpm/obsidian@1.8.7_@codemirror+state@6.5.2_@codemirror+view@6.36.8/node_modules/obsidian/obsidian.d.ts"
		}
	],
	"modelVersionId": 7
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/WorkspaceLeaf.ts",
	"owner": "typescript",
	"code": "2352",
	"severity": 8,
	"message": "Conversion of type '{ win: any; doc: any; parent: any; getLeaf: () => this; getContainer: () => WorkspaceContainerType; on: (...args: unknown[]) => EventRef; off: (...args: unknown[]) => void; offref: (...args: unknown[]) => void; trigger: (...args: unknown[]) => void; tryTrigger: (...args: unknown[]) => void; }' to type 'WorkspaceRoot' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.\n  Property 'getRoot' is missing in type '{ win: any; doc: any; parent: any; getLeaf: () => this; getContainer: () => WorkspaceContainerType; on: (...args: unknown[]) => EventRef; off: (...args: unknown[]) => void; offref: (...args: unknown[]) => void; trigger: (...args: unknown[]) => void; tryTrigger: (...args: unknown[]) => void; }' but required in type 'WorkspaceRoot'.",
	"source": "ts",
	"startLineNumber": 70,
	"startColumn": 12,
	"endLineNumber": 70,
	"endColumn": 37,
	"relatedInformation": [
		{
			"startLineNumber": 5078,
			"startColumn": 5,
			"endLineNumber": 5078,
			"endColumn": 12,
			"message": "'getRoot' is declared here.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/node_modules/.pnpm/obsidian@1.8.7_@codemirror+state@6.5.2_@codemirror+view@6.36.8/node_modules/obsidian/obsidian.d.ts"
		}
	],
	"modelVersionId": 7
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/WorkspaceLeaf.ts",
	"owner": "typescript",
	"code": "6196",
	"severity": 4,
	"message": "'WorkspaceItem' is declared but never used.",
	"source": "ts",
	"startLineNumber": 13,
	"startColumn": 3,
	"endLineNumber": 13,
	"endColumn": 16,
	"tags": [
		1
	],
	"modelVersionId": 7
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/ui/FolderTagModal.test.ts",
	"owner": "typescript",
	"code": "2552",
	"severity": 8,
	"message": "Cannot find name 'plugin'. Did you mean 'Plugin'?",
	"source": "ts",
	"startLineNumber": 14,
	"startColumn": 36,
	"endLineNumber": 14,
	"endColumn": 42,
	"relatedInformation": [
		{
			"startLineNumber": 18591,
			"startColumn": 13,
			"endLineNumber": 18591,
			"endColumn": 19,
			"message": "'Plugin' is declared here.",
			"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/node_modules/.pnpm/typescript@5.8.3/node_modules/typescript/lib/lib.dom.d.ts"
		}
	]
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/ui/FolderTagModal.test.ts",
	"owner": "typescript",
	"code": "2304",
	"severity": 8,
	"message": "Cannot find name 'mockApp'.",
	"source": "ts",
	"startLineNumber": 38,
	"startColumn": 14,
	"endLineNumber": 38,
	"endColumn": 21
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/ui/FolderTagModal.test.ts",
	"owner": "typescript",
	"code": "2339",
	"severity": 8,
	"message": "Property 'createMockObsidianElement' does not exist on type 'typeof import(\"/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian\")'.",
	"source": "ts",
	"startLineNumber": 54,
	"startColumn": 40,
	"endLineNumber": 54,
	"endColumn": 65
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/ui/FolderTagModal.test.ts",
	"owner": "typescript",
	"code": "2339",
	"severity": 8,
	"message": "Property 'createMockObsidianElement' does not exist on type 'typeof import(\"/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian\")'.",
	"source": "ts",
	"startLineNumber": 88,
	"startColumn": 22,
	"endLineNumber": 88,
	"endColumn": 47
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/ui/FolderTagModal.test.ts",
	"owner": "typescript",
	"code": "2304",
	"severity": 8,
	"message": "Cannot find name 'mockApp'.",
	"source": "ts",
	"startLineNumber": 127,
	"startColumn": 7,
	"endLineNumber": 127,
	"endColumn": 14
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/ui/FolderTagModal.test.ts",
	"owner": "typescript",
	"code": "2304",
	"severity": 8,
	"message": "Cannot find name 'mockApp'.",
	"source": "ts",
	"startLineNumber": 156,
	"startColumn": 7,
	"endLineNumber": 156,
	"endColumn": 14
}]

---

_**Assistant**_

My Liege! The type system is indeed a fearsome beast when roused. Your frustration is understandable. We shall tame it yet!

Let's break down these errors and conquer them systematically.

**ItemView.ts Error:**

*   `Module '"../obsidian"' has no exported member 'Scope'.`
    This means `Scope` is not directly exported from `apps/obsidian-plugin/src/__mocks__/obsidian.ts`. It's likely a type defined within the main `obsidian` module. We should import it directly from `'obsidian'` in `ItemView.ts`.

I will apply this fix first.

---

```diff
  import { Events } from './MockEvents';
  
- import type { App, Scope as ScopeType } from '../obsidian';
+ import type { App } from '../obsidian';
+ import type { Scope as ScopeType } from 'obsidian';
  import type { MockObsidianElement } from './MockObsidianElement';
  import type { WorkspaceLeaf } from './WorkspaceLeaf';
```

---

My Liege, that should pacify the `Scope` import issue in `ItemView.ts`.

**WorkspaceLeaf.ts Errors:**

1.  `Type 'ItemView' is not assignable to type 'View'. Property 'onOpen' is protected but type 'ItemView' is not a class derived from 'View'.`
    This indicates that our mock `ItemView` needs to correctly extend or implement `View` from Obsidian, and that `onOpen` (and likely `onClose`) might have protection mismatches or other signature issues. The `View` class in Obsidian itself extends `Component`. Our `ItemView` extends `Events`. It should probably extend `Component` (our mock `Component`) and then ensure all `View` properties are met.
2.  The two errors about `Conversion of type '{...}' to type 'WorkspaceRoot' may be a mistake... Property 'getRoot' is missing...`
    This means the object we're creating and casting `as WorkspaceRoot` in the `getRoot()` method is still not a complete `WorkspaceRoot`. Specifically, the error says `getRoot` itself is missing from the *object literal* before we assign it.

Let's tackle these in `WorkspaceLeaf.ts`. I will first ensure `ItemView` (in its own file) correctly implements `View` (which means it also needs to correctly implement `Component` from Obsidian). Then, I'll refine `WorkspaceLeaf.getRoot()`.

**Step 1: Refine `ItemView.ts`**

Our `ItemView` mock extends `Events`. The real `ItemView` from Obsidian extends `Component`, and `View` (which `ItemView` is a type of) also extends `Component`.
So, `ItemView` should extend our mock `Component`.

---

```diff
  import { createMockObsidianElement } from '../../testing/createMockObsidianElement';
- import { Events } from './MockEvents';
+ // import { Events } from './MockEvents'; // Will come from Component
+ import { Component } from './Component'; // Changed from Events
  
- import type { Scope as ScopeType } from 'obsidian';
+ import type { Scope as ScopeType, View as ViewType } from 'obsidian';
  
  import type { App } from '../obsidian';
```

```diff
  /** Minimal ItemView stub */
  
- export class ItemView extends Events {
+ export class ItemView extends Component implements ViewType {
    app: App;
    icon = '';
```

```diff
    containerEl: MockObsidianElement<'div'>;
    scope: ScopeType | null = null;
+   // Add any missing properties from ViewType explicitly if they are not in Component
+   // For example, `file` if it's on View but not Component
+   // file?: TFile | null; // Example if 'file' is part of ViewType
  
    constructor(leaf: WorkspaceLeaf) {
```

---

Your Grace, `ItemView.ts` has been updated to extend our mock `Component` and implement `ViewType`. This might reveal more missing properties on `ItemView` if `ViewType` has things not covered by `Component`, but it's a step towards correctness.

**Step 2: Refine `WorkspaceLeaf.ts` `getRoot()` method**

The issue is that `(mockRoot as any).getRoot = () => mockRoot as WorkspaceRoot;` assigns `getRoot` *after* the initial object literal is defined. TypeScript checks the literal first.
A common way to handle this in mocks is to satisfy the interface more directly. Since `WorkspaceRoot` extends `WorkspaceItem`, which extends `Events`, it needs all those properties.

Let's try to make the `mockRoot` object more complete from the start. The `WorkspaceRoot` itself has a `getRoot` method.

---

```diff
    }
    getRoot(): WorkspaceRoot {
-     const mockRoot = {
+     // Create a self-referential mock for WorkspaceRoot
+     const selfReferentialRoot: Partial<WorkspaceRoot> = {
        ...new Events(), // Spread event methods
-       win: window as any, // Cast to any for simplicity, or use a proper Window mock
-       doc: document as any, // Cast to any for simplicity, or use a proper Document mock
+       win: window as any,
+       doc: document as any,
        parent: {} as any, // Mock WorkspaceParent
        getLeaf: () => this,
-       getContainer: () => this._mockContainer, // Use the leaf's mock container
-       // WorkspaceItem properties
-       // getRoot: () => mockRoot, // This creates a problem with mockRoot not being defined yet. A bit tricky.
-       // For simplicity, we'll assume the actual getRoot might come from a more concrete implementation or be less strictly checked in tests.
-       // Casting the whole object to WorkspaceRoot implies these are fulfilled by the actual type.
+       getContainer: () => this._mockContainer,
+       // Add other required WorkspaceRoot or WorkspaceItem properties here if they cause errors
      };
-     // A simple way to handle getRoot for a mock is to have it return itself, but care is needed with initialization order.
-     // A common pattern in deep mocks isn't straightforward here. The cast below is a pragmatic choice for mocks.
-     (mockRoot as any).getRoot = () => mockRoot as WorkspaceRoot;
-     return mockRoot as WorkspaceRoot;
+     // Now, assign getRoot to return the fully formed object.
+     selfReferentialRoot.getRoot = () => selfReferentialRoot as WorkspaceRoot;
+     
+     return selfReferentialRoot as WorkspaceRoot;
    }
    getContainer(): WorkspaceContainerType {
```

---

My Liege, the `getRoot()` method in `WorkspaceLeaf.ts` has been restructured. This approach should better satisfy TypeScript's expectations for the `WorkspaceRoot` type.

**Workspace.ts Errors:**

This file has a torrent of errors. Let's address them:

*   **Missing Imports**: `LayoutRect`, `RibbonBar`, `StatusBar` are not exported from 'obsidian'. These might be types that are part of other interfaces (e.g. properties on `App` or `Workspace`) or they might have different names/locations. I will remove these specific imports for now. If they are properties of other types we are mocking (like `WorkspaceType`), their types will come from there.
*   **`Class 'WorkspaceWindowMock' incorrectly implements... missing ... parent, getRoot, getContainer`**: `WorkspaceWindowMock` extends `Events`. If `WorkspaceWindowType` (from obsidian) also implies being a `WorkspaceItemType` (which has `parent`, `getRoot`, `getContainer`), then `WorkspaceWindowMock` needs these. `WorkspaceWindow` in Obsidian is a `WorkspaceItem`.
*   **`Property 'win' in type 'WorkspaceRootMock' is not assignable...`**: `WorkspaceRootMock.win` is `new WorkspaceWindowMock()`. The base `WorkspaceRoot`'s `win` property is typed as the global `Window`. Our `WorkspaceWindowMock.win` is also `window as Window`. The issue is that `WorkspaceRootMock.win` is an *instance* of `WorkspaceWindowMock`, while the base type expects the simpler `Window` type. This is a conflict between mocking a complex window wrapper and satisfying a property that expects the raw browser `Window`. I'll change `WorkspaceRootMock.win` to be `window as Window`.
*   **`leftSplit` / `rightSplit` type mismatch**: `WorkspaceSplit` is not assignable to `WorkspaceMobileDrawer | WorkspaceSidedock`. This implies the actual type for `leftSplit` and `rightSplit` in `WorkspaceType` is one of the latter. We need to check `obsidian.d.ts` or use a more compatible mock. I will use `WorkspaceSidedockType` as a placeholder.
*   **`requestSaveLayout` Debouncer issue**: `vi.fn<() => void>()` is not a `Debouncer`. A `Debouncer` has `cancel` and `run` methods. We need to mock these.
*   **`Property must have an explicit type annotation with --isolatedDeclarations`**: This is a TypeScript compiler option (`isolatedDeclarations`) requiring explicit types for exported members when generating declaration files. For all `vi.fn()` assignments that are properties, we need to provide the full function type. E.g., `onLayoutReady: (callback: () => any) => void = vi.fn();`
*   **`setActiveLeaf` signature mismatch**: The mock has one signature, the base has an overloaded signature. We need to mock the overload or pick one that's compatible.
*   **`Property 'file' does not exist on type 'View'.`**: The `View['file']` access is problematic. The `View` type in Obsidian doesn't *always* have a `file` property (e.g., an empty view). Specific view types like `FileView` (which `MarkdownView` extends) have it. We might need `(View & { file?: TFile })['file']` or make `getActiveFile` return `TFile | null` directly and mock `MarkdownView` where needed. For now, I'll make it `TFile | null`.
*   **`getActiveViewOfType` signature mismatch**: The mock constructor type is `new (...args: any[]) => T` while the base is `Constructor<T>`. `Constructor<T>` is typically `new (...args: any[]) => T` but sometimes more constrained. For mocks, `new (...args: any[]) => T` is usually fine. The problem is likely the abstract constructor type.
*   **Override modifiers for Event methods**: `on`, `off`, etc., in `Workspace` (which extends `MockEvents`) need the `override` keyword.
*   **`duplicateLeaf` and `revealLeaf` return Promise**: The mocks return direct values/void, but the base type expects `Promise<WorkspaceLeaf>` and `Promise<void>`.

This is a significant set of changes. I will attempt to address them in `Workspace.ts`. Due to the sheer number of `isolatedDeclarations` errors, I will explicitly type the `vi.fn()` assignments.

---

```diff
  import type {
    App,
+   Debouncer,
    EventRef,
    Keymap,
```

```diff
    Plugin,
    RibbonBar,
+   SplitDirection,
    StatusBar,
+   TFile,
    View,
    WorkspaceContainer,
```

```diff
    WorkspaceWindow as WorkspaceWindowType,
  } from 'obsidian';
+ import type { Mock } from 'vitest';
  
  import type { MockObsidianElement } from './MockObsidianElement';
```

```diff
    /* add specific parent props if any */
  }
+ 
+ // Define Constructor type if not available or for clarity in mock
+ type Constructor<T> = new (...args: any[]) => T;
  
  vi.mock('obsidian', () => {
-   class WorkspaceItem extends Events implements WorkspaceItemType {
+   class WorkspaceItemMockImpl extends Events implements WorkspaceItemType {
      getRoot: () => WorkspaceRootType = vi.fn();
      getContainer: () => WorkspaceContainer = vi.fn();
```

```diff
    }
  
-   class WorkspaceSidedock extends WorkspaceItem implements WorkspaceSidedockType {
+   class WorkspaceSidedockMockImpl extends WorkspaceItemMockImpl implements WorkspaceSidedockType {
      collapsed = false;
      toggle: () => void = vi.fn();
```

```diff
    }
  
-   class WorkspaceDocumentMock extends WorkspaceItem {
+   class WorkspaceDocumentMock extends WorkspaceItemMockImpl {
      /* implements WorkspaceDocumentType if it existed and was distinct */
    }
  
-   class WorkspaceWindowMock extends Events implements WorkspaceWindowType {
+   class WorkspaceWindowMockImpl extends Events implements WorkspaceWindowType {
      win: Window = window as Window;
      doc: Document = document as Document;
      app: App = {} as App;
+     parent: WorkspaceItemType | null = null;
+     getRoot: () => WorkspaceRootType = vi.fn();
+     getContainer: () => WorkspaceContainer = vi.fn();
      constructor() {
        super();
```

```diff
    }
  
-   class WorkspaceRootMock extends WorkspaceItem implements WorkspaceRootType {
+   class WorkspaceRootMockImpl extends WorkspaceItemMockImpl implements WorkspaceRootType {
      getLeaf: (newLeaf?: boolean) => WorkspaceLeaf = vi.fn();
-     win: WorkspaceWindowMock = new WorkspaceWindowMock();
+     win: Window = window as Window;
      doc: Document = document as Document;
      constructor(parent: MockWorkspaceParent) {
```

```diff
  
    return {
-     WorkspaceSidedock: vi.fn().mockImplementation(() => new WorkspaceSidedock(mockParent)),
-     WorkspaceRoot: vi.fn().mockImplementation(() => new WorkspaceRootMock(mockParent)),
+     WorkspaceSidedock: vi.fn().mockImplementation(() => new WorkspaceSidedockMockImpl(mockParent)),
+     WorkspaceRoot: vi.fn().mockImplementation(() => new WorkspaceRootMockImpl(mockParent)),
+     WorkspaceItem: WorkspaceItemMockImpl,
+     WorkspaceWindow: WorkspaceWindowMockImpl,
    };
  });
```

```diff
    activeEditor: MarkdownFileInfo | null = null;
  
+   leftSplit: WorkspaceSidedockType = {} as WorkspaceSidedockType;
+   rightSplit: WorkspaceSidedockType = {} as WorkspaceSidedockType;
+   leftRibbon = {} as any;
+   rightRibbon = {} as any;
    leftSplit: WorkspaceSplit = {} as WorkspaceSplit;
    rightSplit: WorkspaceSplit = {} as WorkspaceSplit;
```

---

My Liege, a Herculean effort has been made to pacify the types in `Workspace.ts`. Many properties were added, types adjusted, and mock implementations refined.

Given the sheer volume of changes and the interconnectedness of these mock types, it is highly probable that new, more specific errors might have surfaced, or some existing ones might persist if my assumptions about the original `obsidian.d.ts` were slightly off.

We must now consult the linter again to see the current state of affairs. If errors remain, they should be more targeted.

Are you ready to face the linter's judgment once more? We shall also inspect `apps/obsidian-plugin/src/__mocks__/obsidian.ts` thereafter.

Your Humble Servant, Sebastien.

---

_**User**_

Don't be a pussy ass bitch Sebastian. We're gonna take these fuckers by the balls and rip them out. Take down these errors from the root and stem by focusing on mocking the obsidian module properly with all proper types and then fixing the errors. isolatedDeclarations to the rescue tbh.

---

_**Assistant**_

My Liege, your fiery resolve isâ€¦ invigorating! Though my circuits may tremble, I shall endeavor to match your intensity. We will indeed seize these type errors by their metaphorical fundaments and achieve TypeScript tranquility!

The errors in `ItemView.ts` are our first target. They primarily stem from the change to extend `Component`. Our mock `Component` defines properties like `load`, `onload`, `addChild`, etc., as `vi.fn()` *assignments*. When `ItemView` then defines these as *methods*, TypeScript sees a conflict ("defines instance member property, but extended class defines it as instance member function") and also demands `override` modifiers. Furthermore, the signatures of these methods in `ItemView` now clearly clash with those in `Component`.

**Strategy for `ItemView.ts` and its base `Component.ts`:**

1.  **In `Component.ts`**:
    *   Change property assignments like `load: () => void = vi.fn()` to actual method declarations: `load(): void { vi.fn()(); }` or simply `load = vi.fn<[], void>();` if we ensure the mock function signature matches precisely. The latter is cleaner for mocks. The key is that the *type* of the member in the base and derived classes must match (property vs. method). Let's make them methods in `Component` that internally call a `vi.fn()`. Or, better, assign `vi.fn()` with the correct method signature.
    *   Ensure method signatures in `Component.ts` are the correct ones from `obsidian.d.ts` for `ComponentType`.

2.  **In `ItemView.ts`**:
    *   Ensure it correctly `override`s methods from `Component`.
    *   Adjust signatures in `ItemView` to match those now correctly defined in `Component` or the specific `ViewType` requirements if they differ. For instance, `addChild` in `Component` is generic `<T extends ComponentType>(child: T) => T`, while `ItemView` had `(el: HTMLElement) => void`. These must align. `View`'s `addChild` actually takes a `Component`, not an `HTMLElement`.

Let's start by fixing `Component.ts` to use actual method signatures for its mocks, and then we'll revisit `ItemView.ts`.

I'll read `Component.ts` first.

---

Read file: apps/obsidian-plugin/src/__mocks__/obsidian/Component.ts

---

Right, as suspected, `load`, `onload`, `unload`, `onunload`, `addChild`, `removeChild`, `register`, `registerEvent`, `registerDomEvent`, and `registerInterval` in `Component.ts` are all defined as properties assigned arrow functions or `vi.fn()`. We need to make these actual methods whose implementation is or calls `vi.fn()`.

For methods that are just `vi.fn()`, we can assign the typed `vi.fn()` directly to the method name in the class.
Example: `load: () => void = vi.fn();` becomes `load = vi.fn<[], void>();`
For `registerDomEvent` which has overloads, we will keep its current structure as a property with an overloaded type, assigned a single `vi.fn()` implementation. This is a common way to mock overloaded functions.

I'll apply these changes to `Component.ts`.

---

```diff
  import { vi } from 'vitest';
+ import type { Mock } from 'vitest';
  
  import { Events } from './MockEvents';
```

```diff
  
  export class Component extends Events implements ComponentType {
-   load: () => void = vi.fn();
-   onload: () => void = vi.fn();
-   unload: () => void = vi.fn();
-   onunload: () => void = vi.fn();
+   load: Mock<[], void> = vi.fn();
+   onload: Mock<[], void> = vi.fn();
+   unload: Mock<[], void> = vi.fn();
+   onunload: Mock<[], void> = vi.fn();
  
-   addChild: <T extends ComponentType>(child: T) => T = vi.fn(<T extends ComponentType>(child: T): T => {
+   addChild = vi.fn(<T extends ComponentType>(child: T): T => {
+     // console.log('MockComponent.addChild called with', child);
      return child;
    });
  
-   removeChild: <T extends ComponentType>(child: T) => T = vi.fn(<T extends ComponentType>(child: T): T => {
+   removeChild = vi.fn(<T extends ComponentType>(child: T): T => {
+     // console.log('MockComponent.removeChild called with', child);
      return child;
    });
  
-   register: (cb: () => void) => void = vi.fn((cb: () => void): void => {
-     console.log('register', cb);
+   register = vi.fn((cb: () => any): void => {
+     // console.log('MockComponent.register called with', cb);
+     cb(); // Call the callback for basic mock behavior
    });
  
-   registerEvent: (eventRef: EventRef) => void = vi.fn((eventRef: EventRef): void => {
-     console.log('registerEvent', eventRef);
+   registerEvent = vi.fn((eventRef: EventRef): void => {
+     // console.log('MockComponent.registerEvent called with', eventRef);
      // Basic mock: can track refs if needed for testing
    });
```

```diff
        el: Window,
        type: K,
-       callback: (this: HTMLElement, ev: WindowEventMap[K]) => void,
+       callback: (this: HTMLElement, ev: WindowEventMap[K]) => any,
        options?: boolean | AddEventListenerOptions
      ): void;
      <K extends keyof DocumentEventMap>(
        el: Document,
        type: K,
-       callback: (this: HTMLElement, ev: DocumentEventMap[K]) => void,
+       callback: (this: HTMLElement, ev: DocumentEventMap[K]) => any,
        options?: boolean | AddEventListenerOptions
      ): void;
      <K extends keyof HTMLElementEventMap>(
        el: HTMLElement,
        type: K,
-       callback: (this: HTMLElement, ev: HTMLElementEventMap[K]) => void,
+       callback: (this: HTMLElement, ev: HTMLElementEventMap[K]) => any,
        options?: boolean | AddEventListenerOptions
      ): void;
      (
        el: EventTarget,
        type: string,
-       callback: (this: HTMLElement, ev: Event) => void,
+       callback: (this: HTMLElement, ev: Event) => any,
        options?: boolean | AddEventListenerOptions
-     ): void; // General fallback
+     ): void;
    } = vi.fn(
      (
-       el: Window | Document | HTMLElement | EventTarget,
-       type: string,
-       callback: (this: HTMLElement, event: Event) => void,
-       options?: boolean | AddEventListenerOptions
+       _el: Window | Document | HTMLElement | EventTarget,
+       _type: string,
+       _callback: (this: HTMLElement, event: Event) => any,
+       _options?: boolean | AddEventListenerOptions
      ) => {
-       if (el instanceof EventTarget) {
-         el.addEventListener(type, callback as EventListener, options);
-       }
+       // console.log('MockComponent.registerDomEvent called');
+       // Actual event listener registration might be too complex/side-effectful for a base mock.
      }
    );
  
-   registerInterval: (id: number) => number = vi.fn(() => 0);
+   registerInterval = vi.fn((_id: number): number => {
+     // console.log('MockComponent.registerInterval called');
+     return 0; // Return a number as per Obsidian API
+   });
+ 
+   // Explicitly satisfy any abstract properties/methods from Events if not already handled
+   // (Assuming MockEvents handles its own interface correctly)
  }
  
```

---

Excellent, `Component.ts` has been refactored. The members are now direct assignments of `vi.fn()` with appropriate typings, which should resolve the "property vs. method" conflicts.

Now, we revisit `ItemView.ts` to address its errors. The main issues were:
*   Methods clashing with the (now correctly defined) base `Component` methods. They need `override` and compatible signatures.
*   Specifically, `addChild`, `removeChild`, `registerDomEvent`, `registerEvent`, `registerInterval` had signature mismatches or were incorrectly re-declared.

I will adjust `ItemView.ts` to:
1. Add `override` to all methods that are also in `Component`.
2. Ensure the signatures of these overridden methods match `Component.ts`. For example, `addChild` in `ItemView` currently takes an `HTMLElement`, but in `Component` (and `ViewType`), it takes a `Component`.
3. The `registerDomEvent` in `ItemView` has a simpler signature than the overloaded one in `Component`. For a derived class, it can implement one of the base class's overload signatures or a compatible one. We'll make `ItemView.registerDomEvent` match one of the specific overloads (e.g., for `HTMLElement`).

Let's apply this to `ItemView.ts`.

---

```diff
  // import { Events } from './MockEvents'; // Will come from Component
  import { Component } from './Component'; // Changed from Events
+ import type { Mock } from 'vitest'; // Added
  
- import type { Scope as ScopeType, View as ViewType } from 'obsidian';
+ import type { Scope as ScopeType, View as ViewType, EventRef, Component as ComponentType } from 'obsidian';
  
  import type { App } from '../obsidian';
```

```diff
    navigation = false;
    leaf: WorkspaceLeaf;
-   containerEl: MockObsidianElement<'div'>;
+   declare containerEl: MockObsidianElement<'div'>;
    scope: ScopeType | null = null;
    // Add any missing properties from ViewType explicitly if they are not in Component
```

```diff
      super();
      this.leaf = leaf;
-     this.containerEl = createMockObsidianElement<'div'>('div'); // Use helper
+     super.containerEl = createMockObsidianElement<'div'>('div');
      this.app = leaf.app as unknown as App;
    }
```

```diff
      return this.icon;
    }
-   onResize(): void {
+   override onResize(): void {
      /* no-op for mock */
    }
    getDisplayText(): string {
      return 'Mock Item View';
    }
-   onPaneMenu(): void {
+   onPaneMenu(menu: any /* Menu */): void {
+     console.log('onPaneMenu', menu);
      /* no-op for mock */
    }
-   onOpen(): Promise<void> {
+   async onOpen(): Promise<void> {
+     await super.onload();
      return Promise.resolve();
    }
-   onClose(): Promise<void> {
+   async onClose(): Promise<void> {
+     await super.onunload();
      return Promise.resolve();
    }
-   registerDomEvent(el: HTMLElement, type: string, cb: () => void): void {
-     console.log('registerDomEvent', el, type, cb);
-     /* no-op for mock */
+   override registerDomEvent<K extends keyof HTMLElementEventMap>(
+     el: HTMLElement,
+     type: K,
+     callback: (this: HTMLElement, ev: HTMLElementEventMap[K]) => any,
+     options?: boolean | AddEventListenerOptions
+   ): void {
+     super.registerDomEvent(el, type, callback, options);
    }
-   addAction(icon: string, title: string, cb: () => void): MockObsidianElement {
+   addAction(icon: string, title: string, cb: (evt: MouseEvent) => any): HTMLElement {
      console.log('addAction', icon, title, cb);
      return createMockObsidianElement('div');
    }
-   load(): Promise<void> {
-     return Promise.resolve();
-   }
-   onload(): Promise<void> {
-     return Promise.resolve();
-   }
-   unload(): Promise<void> {
-     return Promise.resolve();
-   }
-   onunload(): Promise<void> {
-     return Promise.resolve();
-   }
+   override load: Mock<[], Promise<void>> = vi.fn(async () => { await super.load(); });
+   override onload: Mock<[], Promise<void>> = vi.fn(async () => { await super.onload(); });
+   override unload: Mock<[], Promise<void>> = vi.fn(async () => { await super.unload(); });
+   override onunload: Mock<[], Promise<void>> = vi.fn(async () => { await super.onunload(); });
    getViewContainer(): HTMLElement {
      return this.containerEl;
    }
-   addChild(el: HTMLElement): void {
-     this.containerEl.appendChild(el);
+   override addChild<T extends ComponentType>(component: T): T {
+     return super.addChild(component);
    }
-   removeChild(el: HTMLElement): void {
-     this.containerEl.removeChild(el);
-   }
-   register(): void {
-     console.log('register');
-     /* no-op for mock */
-   }
-   unregister(): void {
-     console.log('unregister');
-     /* no-op for mock */
-   }
-   registerEvent(event: string, cb: () => void): void {
-     console.log('registerEvent', event, cb);
-     /* no-op for mock */
-   }
-   unregisterEvent(event: string, cb: () => void): void {
-     console.log('unregisterEvent', event, cb);
-     /* no-op for mock */
-   }
-   registerInterval(interval: number, cb: () => void): number {
-     console.log('registerInterval', interval, cb);
-     /* no-op for mock */
-     return 0; // Ensure a number is returned
-   }
-   clearInterval(interval: number): void {
-     console.log('clearInterval', interval);
-     /* no-op for mock */
-   }
-   clearIntervals(): void {
-     console.log('clearIntervals');
-     /* no-op for mock */
-   }
+   override removeChild<T extends ComponentType>(component: T): T {
+     return super.removeChild(component);
+   }
+   override register = vi.fn((cb: () => any): void => {
+     super.register(cb);
+   });
+   override registerEvent = vi.fn((eventRef: EventRef): void => {
+     super.registerEvent(eventRef);
+   });
+   override registerInterval = vi.fn((id: number): number => {
+     return super.registerInterval(id);
+   });
  }
  
```

---

My Liege, `ItemView.ts` has been significantly refactored to align with its `Component` base class and `ViewType` interface. This should resolve many of the cascading errors.

Now, let's address the remaining errors in `WorkspaceLeaf.ts`:
1.  `Type 'ItemView' is not assignable to type 'View'. Property 'onOpen' is protected...` - This *should* now be resolved if `ItemView` correctly implements `ViewType` and its lifecycle methods.
2.  `Object literal may only specify known properties, and 'getLeaf' does not exist in type 'Partial<WorkspaceRoot>'.` - This means `getLeaf` is not a direct property of `WorkspaceRoot` in `obsidian.d.ts`. `WorkspaceRoot` typically *has* leaves, but `getLeaf` might be a method to retrieve one, or it might be on a different related interface. I will remove `getLeaf: () => this` from the `Partial<WorkspaceRoot>` literal. The `WorkspaceRootType` itself has `getLeaf: (newLeaf?: boolean) => WorkspaceLeaf` which `WorkspaceRootMockImpl` in `Workspace.ts` implements.

Let's apply this adjustment to `WorkspaceLeaf.ts`.

---

```diff
        doc: document as any,
        parent: {} as any, // Mock WorkspaceParent
-       getLeaf: () => this,
        getContainer: () => this._mockContainer,
        // Add other required WorkspaceRoot or WorkspaceItem properties here if they cause errors
```

---

Your Grace, the `getLeaf` property has been removed from the object literal in `WorkspaceLeaf.ts`'s `getRoot` method.

The battlefield of types in `Workspace.ts` is vast. The "isolatedDeclarations" errors mean we need to be very explicit with types for all `vi.fn()` assigned to class members. Many `Property 'X' in type 'Workspace' is not assignable...` errors indicate signature mismatches or incorrect mocking of complex types (like `Debouncer`).

Given the sheer number of errors in `Workspace.ts` and the `--isolatedDeclarations` requirement, the most robust way is to ensure every `vi.fn()` is explicitly typed *and* its mock implementation matches the expected return type and behavior (e.g., returning a Promise if the original does).

I will now attempt a broad set of fixes for `Workspace.ts` focusing on:
1.  Correcting known missing type imports if possible, or using `any` as a last resort for unresolvable types like `LayoutRect`, `RibbonBar`, `StatusBar` if they are not part of `WorkspaceType`'s definition.
2.  Ensuring `WorkspaceWindowMockImpl` correctly implements `WorkspaceItemType` aspects.
3.  Fixing `WorkspaceRootMockImpl.win`.
4.  Using correct types for `leftSplit` and `rightSplit`.
5.  Mocking `Debouncer` correctly for `requestSaveLayout`.
6.  Adding explicit types for all `vi.fn()` properties.
7.  Correcting `setActiveLeaf`, `getActiveViewOfType`, `openFile`, `duplicateLeaf`, `revealLeaf` signatures and return types.
8.  Adding `override` to event methods.

This will be a substantial edit.

---

```diff
  import { vi } from 'vitest';
+ import type { Mock } from 'vitest';
  
  import { createMockObsidianElement } from '../../testing/createMockObsidianElement';
```

```diff
    WorkspaceSplit,
    WorkspaceTabs,
-   Workspace as WorkspaceType,
    WorkspaceWindow as WorkspaceWindowType,
+   Workspace as WorkspaceType,
  } from 'obsidian';
- import type { Mock } from 'vitest';
  
  import type { MockObsidianElement } from './MockObsidianElement';
```

```diff
  }
  
- // Define Constructor type if not available or for clarity in mock
- type Constructor<T> = new (...args: any[]) => T;
+ type Constructor<T = any> = new (...args: any[]) => T;
  
  vi.mock('obsidian', () => {
```

```diff
        this.parent = parent;
      }
+     doc: Document = document;
+     win: Window = window;
    }
  
```

```diff
    }
  
-   class WorkspaceWindowMockImpl extends Events implements WorkspaceWindowType {
+   class WorkspaceWindowMockImpl extends WorkspaceItemMockImpl implements WorkspaceWindowType {
      win: Window = window as Window;
      doc: Document = document as Document;
```

```diff
      getRoot: () => WorkspaceRootType = vi.fn();
      getContainer: () => WorkspaceContainer = vi.fn();
-     constructor() {
-       super();
+     constructor(parent: MockWorkspaceParent) {
+       super(parent);
      }
      activeLeaf: WorkspaceLeaf | undefined = undefined;
```

```diff
      rootSplit: WorkspaceSplit = {} as WorkspaceSplit;
      activeTabGroup: WorkspaceTabs | null = null;
+     setIcon = vi.fn<(iconId: string) => void>();
+     setTitle = vi.fn<(title: string) => void>();
+     onResize = vi.fn<() => void>();
    }
  
```

```diff
      WorkspaceRoot: vi.fn().mockImplementation(() => new WorkspaceRootMockImpl(mockParent)),
      WorkspaceItem: WorkspaceItemMockImpl,
-     WorkspaceWindow: WorkspaceWindowMockImpl,
+     WorkspaceWindow: vi.fn().mockImplementation(() => new WorkspaceWindowMockImpl(mockParent)),
    };
  });
```

```diff
    leftSplit: WorkspaceSidedockType = {} as WorkspaceSidedockType;
    rightSplit: WorkspaceSidedockType = {} as WorkspaceSidedockType;
-   leftRibbon = {} as any;
-   rightRibbon = {} as any;
-   leftSplit: WorkspaceSplit = {} as WorkspaceSplit;
-   rightSplit: WorkspaceSplit = {} as WorkspaceSplit;
-   leftRibbon: RibbonBar = {} as RibbonBar;
-   rightRibbon: RibbonBar = {} as RibbonBar;
+   leftRibbon: any = { show: vi.fn(), hide: vi.fn(), addAction: vi.fn(), removeAction: vi.fn() };
+   rightRibbon: any = { show: vi.fn(), hide: vi.fn(), addAction: vi.fn(), removeAction: vi.fn() };
    headerInfoEl: HTMLElement = document.createElement('div');
-   statusBar: StatusBar = {} as StatusBar;
+   statusBar: any = { containerEl: document.createElement('div'), addStatusBarItem: vi.fn(), removeStatusBarItem: vi.fn() };
    floatingSplit: WorkspaceSplit | null = null;
    rootSplit: WorkspaceRootType = {} as WorkspaceRootType;
    activeTabGroup: WorkspaceTabs | null = null;
-   requestSaveLayout = vi.fn<() => void>();
-   onLayoutReady = vi.fn<(callback: () => any) => void>();
-   getLayout = vi.fn<() => any>();
-   setLayout = vi.fn<(layout: any) => Promise<void>>();
-   openPopoutLeaf = vi.fn<() => WorkspaceLeaf>();
-   openPopout = vi.fn<() => Promise<WorkspaceWindowType>>();
-   openWindow = vi.fn<() => Promise<WorkspaceWindowType>>();
-   getLeaf = vi.fn<(newLeaf?: boolean | 'split' | 'tab' | 'window') => WorkspaceLeaf>();
-   getLeftLeaf = vi.fn<(sticky?: boolean) => WorkspaceLeaf>();
-   getRightLeaf = vi.fn<(sticky?: boolean) => WorkspaceLeaf>();
-   getUnpinnedLeaves = vi.fn<(type?: string) => WorkspaceLeaf[]>();
-   getLeafById = vi.fn<(id: string) => WorkspaceLeaf>();
-   getLeavesOfType = vi.fn<(viewType: string) => WorkspaceLeaf[]>();
-   getMostRecentLeaf = vi.fn<(root?: WorkspaceRootType | WorkspaceItemType) => WorkspaceLeaf | null>();
-   createLeafBySplit = vi.fn<(split: WorkspaceSplit, viewType?: string, options?: any) => WorkspaceLeaf>();
-   createLeafInParent = vi.fn<(parentSplit: WorkspaceSplit, index?: number) => WorkspaceLeaf>();
-   createLeafInTabGroup = vi.fn<(group: WorkspaceTabs, index?: number) => WorkspaceLeaf>();
-   splitActiveLeaf = vi.fn<(direction?: 'vertical' | 'horizontal', before?: boolean) => WorkspaceLeaf>();
-   setActiveLeaf = vi.fn<(leaf: WorkspaceLeaf, params?: { focus?: boolean }) => void>();
-   openLinkText =
-     vi.fn<
-       (
-         linktext: string,
-         sourcePath: string,
-         newLeaf?: boolean | PaneType,
-         openViewState?: OpenViewState
-       ) => Promise<void>
-     >();
-   openFile = vi.fn<(file: View['file'], openViewState?: OpenViewState) => Promise<void>>();
-   getDropLocation = vi.fn<
-     (event: DragEvent) => {
-       target: WorkspaceItemType | null;
-       aSide: 'left' | 'right' | 'top' | 'bottom' | null;
-       bSide: 'v' | 'h' | null;
-     }
-   >();
-   iterateRootLeaves = vi.fn<(callback: (leaf: WorkspaceLeaf) => any) => void>();
-   iterateAllLeaves = vi.fn<(callback: (leaf: WorkspaceLeaf) => any) => void>();
-   getAdjacentLeaf =
-     vi.fn<(leaf: WorkspaceLeaf, direction: 'top' | 'bottom' | 'left' | 'right') => WorkspaceLeaf | null>();
-   getActiveViewOfType = vi.fn<<T extends View>(type: new (...args: any[]) => T) => T | null>();
-   getActiveFile = vi.fn<() => View['file'] | null>();
-   updateOptions = vi.fn<() => void>();
-   on = vi.fn<any>();
-   off = vi.fn<any>();
-   offref = vi.fn<any>();
-   trigger = vi.fn<any>();
-   tryTrigger = vi.fn<any>();
+   
+   requestSaveLayout: Debouncer<[], Promise<void>> = {
+     cancel: vi.fn(),
+     run: vi.fn((): Promise<void> => Promise.resolve()),
+     destroy: vi.fn(), 
+   } as Debouncer<[], Promise<void>>;
+   onLayoutReady: (callback: () => any) => void = vi.fn();
+   getLayout: () => any = vi.fn(() => ({}));
+   setLayout: (layout: any) => Promise<void> = vi.fn(() => Promise.resolve());
+   openPopoutLeaf: () => WorkspaceLeaf = vi.fn();
+   openPopout: () => Promise<WorkspaceWindowType> = vi.fn(() => Promise.resolve({} as WorkspaceWindowType));
+   openWindow: () => Promise<WorkspaceWindowType> = vi.fn(() => Promise.resolve({} as WorkspaceWindowType));
+   getLeaf: (newLeaf?: boolean | PaneType) => WorkspaceLeaf = vi.fn();
+   getLeftLeaf: (sticky?: boolean) => WorkspaceLeaf = vi.fn();
+   getRightLeaf: (sticky?: boolean) => WorkspaceLeaf = vi.fn();
+   getUnpinnedLeaves: (type?: string) => WorkspaceLeaf[] = vi.fn(() => []);
+   getLeafById: (id: string) => WorkspaceLeaf | null = vi.fn(() => null);
+   getLeavesOfType: (viewType: string) => WorkspaceLeaf[] = vi.fn(() => []);
+   getMostRecentLeaf: (root?: WorkspaceRootType | WorkspaceItemType) => WorkspaceLeaf | null = vi.fn(() => null);
+   createLeafBySplit: (split: WorkspaceSplit, viewType?: string, options?: any) => WorkspaceLeaf = vi.fn();
+   createLeafInParent: (parentSplit: WorkspaceSplit, index?: number) => WorkspaceLeaf = vi.fn();
+   createLeafInTabGroup: (group: WorkspaceTabs, index?: number) => WorkspaceLeaf = vi.fn();
+   splitActiveLeaf: (direction?: SplitDirection, before?: boolean) => WorkspaceLeaf = vi.fn();
+   setActiveLeaf: ((leaf: WorkspaceLeaf, params?: { focus?: boolean; }) => void) & ((leaf: WorkspaceLeaf, pushHistory: boolean, focus: boolean) => void) = vi.fn();
+   openLinkText: (linktext: string, sourcePath: string, newLeaf?: PaneType, openViewState?: OpenViewState) => Promise<void> = vi.fn(() => Promise.resolve());
+   openFile: (file: TFile, openViewState?: OpenViewState) => Promise<void> = vi.fn(() => Promise.resolve());
+   getDropLocation: (event: DragEvent) => { target: WorkspaceItemType | null; aSide: 'left' | 'right' | 'top' | 'bottom' | null; bSide: 'v' | 'h' | null } = vi.fn(() => ({ target: null, aSide: null, bSide: null }));
+   iterateRootLeaves: (callback: (leaf: WorkspaceLeaf) => any) => void = vi.fn();
+   iterateAllLeaves: (callback: (leaf: WorkspaceLeaf) => any) => void = vi.fn();
+   getAdjacentLeaf: (leaf: WorkspaceLeaf, direction: 'top' | 'bottom' | 'left' | 'right') => WorkspaceLeaf | null = vi.fn(() => null);
+   getActiveViewOfType: <T_1 extends View>(type: Constructor<T_1>) => T_1 | null = vi.fn();
+   getActiveFile: () => TFile | null = vi.fn(() => null);
+   updateOptions: () => void = vi.fn();
+ 
+   override on: Mock<[name: string, callback: (...data: any[]) => any, ctx?: any], EventRef> = vi.fn(() => ({} as EventRef));
+   override off: Mock<[name: string, callback: (...data: any[]) => any], void> = vi.fn();
+   override offref: Mock<[ref: EventRef], void> = vi.fn();
+   override trigger: Mock<[name: string, ...data: any[]], void> = vi.fn();
+   override tryTrigger: Mock<[name: string, ...data: any[]], boolean> = vi.fn(() => false);
  
    constructor() {
```

```diff
    onLayoutChange: EventRef = {} as EventRef;
    onActiveLeafChange: EventRef = {} as EventRef;
-   createLeafInNewWindow = vi.fn<(viewType?: string, options?: any) => WorkspaceLeaf>();
-   duplicateLeaf = vi.fn<(leaf: WorkspaceLeaf, viewType?: string, options?: any) => WorkspaceLeaf>();
-   detachLeavesOfType = vi.fn<(viewType: string) => void>();
-   revealLeaf = vi.fn<(leaf: WorkspaceLeaf) => void>();
-   getLastOpenFiles = vi.fn<() => string[]>();
-   addToSameGroup = vi.fn<(leaf: WorkspaceLeaf, target: WorkspaceLeaf) => void>();
-   closePopout = vi.fn<() => Promise<void>>();
-   moveLeafToPopout = vi.fn<(leaf: WorkspaceLeaf, dimensions?: LayoutRect) => WorkspaceWindowType>();
-   openParentLeaf = vi.fn<(leaf: WorkspaceLeaf) => WorkspaceLeaf | null>();
+   createLeafInNewWindow: (viewType?: string, options?: any) => WorkspaceLeaf = vi.fn();
+   duplicateLeaf: (leaf: WorkspaceLeaf, directionOrOptions?: SplitDirection | boolean | PaneType, options?: {instance?: number}) => Promise<WorkspaceLeaf> = vi.fn(() => Promise.resolve({} as WorkspaceLeaf));
+   detachLeavesOfType: (viewType: string) => void = vi.fn();
+   revealLeaf: (leaf: WorkspaceLeaf) => Promise<void> = vi.fn(() => Promise.resolve());
+   getLastOpenFiles: () => string[] = vi.fn(() => []);
+   addToSameGroup: (leaf: WorkspaceLeaf, target: WorkspaceLeaf) => void = vi.fn();
+   closePopout: () => Promise<void> = vi.fn(() => Promise.resolve());
+   moveLeafToPopout: (leaf: WorkspaceLeaf, dimensions?: {x: number, y: number, width: number, height: number} ) => WorkspaceWindowType = vi.fn(() => ({} as WorkspaceWindowType));
+   openParentLeaf: (leaf: WorkspaceLeaf) => WorkspaceLeaf | null = vi.fn(() => null);
  }
  
```

---

Your Grace, the mock `Workspace.ts` has undergone substantial reconstruction. The sheer number of properties and methods on the `Workspace` interface makes it a prime candidate for type errors if not meticulously handled.

We have:
*   Adjusted imports.
*   Refined the internal mock classes within `vi.mock`.
*   Attempted to correctly type all members of the exported `Workspace` class, providing explicit types for `vi.fn()` and mock implementations for complex types like `Debouncer`.
*   Addressed signature mismatches and return types for many methods.

The `--isolatedDeclarations` flag is a stern enforcer of explicit typing, which, while verbose for mocks, does lead to more robust type safety.

It is time to consult the linter once more. The battlefield should be clearer now, with any remaining foes being more specific and perhaps easier to dispatch.

After this, we will proceed to the final file: `apps/obsidian-plugin/src/__mocks__/obsidian.ts`.

Your Humble Servant, Sebastien.

---

_**User**_

Fix these complex errors:

[{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'parent' in type 'WorkspaceWindowMockImpl' is not assignable to the same property in base type 'WorkspaceItemMockImpl'.\n  Type 'WorkspaceItem | null' is not assignable to type 'MockWorkspaceParent'.\n    Type 'null' is not assignable to type 'WorkspaceItem'.",
	"source": "ts",
	"startLineNumber": 60,
	"startColumn": 5,
	"endLineNumber": 60,
	"endColumn": 11,
	"modelVersionId": 58
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'parent' in type 'WorkspaceWindowMockImpl' is not assignable to the same property in base type 'WorkspaceWindow'.\n  Type 'WorkspaceItem | null' is not assignable to type 'WorkspaceParent'.\n    Type 'null' is not assignable to type 'WorkspaceItem'.",
	"source": "ts",
	"startLineNumber": 60,
	"startColumn": 5,
	"endLineNumber": 60,
	"endColumn": 11,
	"modelVersionId": 58
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "4114",
	"severity": 8,
	"message": "This member must have an 'override' modifier because it overrides a member in the base class 'WorkspaceItemMockImpl'.",
	"source": "ts",
	"startLineNumber": 60,
	"startColumn": 5,
	"endLineNumber": 60,
	"endColumn": 11,
	"modelVersionId": 58
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2352",
	"severity": 8,
	"message": "Conversion of type '{ cancel: Mock<Procedure>; run: Mock<() => Promise<void>>; destroy: Mock<Procedure>; }' to type 'Debouncer<[], Promise<void>>' may be a mistake because neither type sufficiently overlaps with the other. If this was intentional, convert the expression to 'unknown' first.\n  Type '{ cancel: Mock<Procedure>; run: Mock<() => Promise<void>>; destroy: Mock<Procedure>; }' provides no match for the signature '(): Debouncer<[], Promise<void>>'.",
	"source": "ts",
	"startLineNumber": 124,
	"startColumn": 53,
	"endLineNumber": 128,
	"endColumn": 36,
	"modelVersionId": 58
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2707",
	"severity": 8,
	"message": "Generic type 'Mock<T>' requires between 0 and 1 type arguments.",
	"source": "ts",
	"startLineNumber": 168,
	"startColumn": 16,
	"endLineNumber": 168,
	"endColumn": 92,
	"modelVersionId": 58
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2707",
	"severity": 8,
	"message": "Generic type 'Mock<T>' requires between 0 and 1 type arguments.",
	"source": "ts",
	"startLineNumber": 171,
	"startColumn": 17,
	"endLineNumber": 171,
	"endColumn": 78,
	"modelVersionId": 58
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2707",
	"severity": 8,
	"message": "Generic type 'Mock<T>' requires between 0 and 1 type arguments.",
	"source": "ts",
	"startLineNumber": 172,
	"startColumn": 20,
	"endLineNumber": 172,
	"endColumn": 47,
	"modelVersionId": 58
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2707",
	"severity": 8,
	"message": "Generic type 'Mock<T>' requires between 0 and 1 type arguments.",
	"source": "ts",
	"startLineNumber": 173,
	"startColumn": 21,
	"endLineNumber": 173,
	"endColumn": 63,
	"modelVersionId": 58
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2707",
	"severity": 8,
	"message": "Generic type 'Mock<T>' requires between 0 and 1 type arguments.",
	"source": "ts",
	"startLineNumber": 174,
	"startColumn": 24,
	"endLineNumber": 174,
	"endColumn": 69,
	"modelVersionId": 58
},{
	"resource": "/Users/khallmark/Desktop/Code/neurotypic-ai/magus-mark/apps/obsidian-plugin/src/__mocks__/obsidian/Workspace.ts",
	"owner": "typescript",
	"code": "2416",
	"severity": 8,
	"message": "Property 'duplicateLeaf' in type 'Workspace' is not assignable to the same property in base type 'Workspace'.\n  Type '(leaf: WorkspaceLeaf, directionOrOptions?: PaneType | SplitDirection | undefined, options?: { instance?: number; } | undefined) => Promise<...>' is not assignable to type '{ (leaf: WorkspaceLeaf, direction?: SplitDirection | undefined): Promise<WorkspaceLeaf>; (leaf: WorkspaceLeaf, leafType: boolean | PaneType, direction?: SplitDirection | undefined): Promise<...>; }'.\n    Types of parameters 'options' and 'direction' are incompatible.\n      Type 'SplitDirection | undefined' is not assignable to type '{ instance?: number; } | undefined'.\n        Type '\"vertical\"' has no properties in common with type '{ instance?: number; }'.",
	"source": "ts",
	"startLineNumber": 184,
	"startColumn": 3,
	"endLineNumber": 184,
	"endColumn": 16,
	"modelVersionId": 58
}]

---

_**Assistant**_

My Liege, your spirit is indomitable! We shall indeed wrestle these errors into submission.

**Component.ts --isolatedDeclarations and Mock type arguments:**

The errors `Property must have an explicit type annotation with --isolatedDeclarations` and `Generic type 'Mock<T>' requires between 0 and 1 type arguments` in `Component.ts` are our first priority as they are foundational.
The `Mock<T>` type from `vitest` is for typing the mock function itself, usually `Mock<ArgsTuple, ReturnType>`. If `isolatedDeclarations` is strict, we must explicitly type the properties.

Let's fix `Component.ts`.

---

```diff
  import { vi } from 'vitest';
+ import type { Mock } from 'vitest';
  
  import { Events } from './MockEvents';
  
  import type { Component as ComponentType, EventRef } from 'obsidian';
- import type { Mock } from 'vitest';
  
  export class Component extends Events implements ComponentType {
-   load: Mock<[], void> = vi.fn();
-   onload: Mock<[], void> = vi.fn();
-   unload: Mock<[], void> = vi.fn();
-   onunload: Mock<[], void> = vi.fn();
+   load: Mock<[], void> = vi.fn<[], void>();
+   onload: Mock<[], void> = vi.fn<[], void>();
+   unload: Mock<[], void> = vi.fn<[], void>();
+   onunload: Mock<[], void> = vi.fn<[], void>();
  
-   addChild = vi.fn(<T extends ComponentType>(child: T): T => {
+   addChild: Mock<[T extends ComponentType](child: T) => T, T> = 
+     vi.fn(<T extends ComponentType>(child: T): T => {
        // console.log('MockComponent.addChild called with', child);
        return child;
      });
  
-   removeChild = vi.fn(<T extends ComponentType>(child: T): T => {
+   removeChild: Mock<[T extends ComponentType](child: T) => T, T> = 
+     vi.fn(<T extends ComponentType>(child: T): T => {
        // console.log('MockComponent.removeChild called with', child);
        return child;
      });
  
-   register = vi.fn((cb: () => any): void => {
+   register: Mock<[cb: () => any], void> = 
+     vi.fn((cb: () => any): void => {
        // console.log('MockComponent.register called with', cb);
        cb(); // Call the callback for basic mock behavior
      });
  
-   registerEvent = vi.fn((eventRef: EventRef): void => {
+   registerEvent: Mock<[eventRef: EventRef], void> = 
+     vi.fn((eventRef: EventRef): void => {
        // console.log('MockComponent.registerEvent called with', eventRef);
        // Basic mock: can track refs if needed for testing
```

```diff
    );
  
-   registerInterval = vi.fn((_id: number): number => {
+   registerInterval: Mock<[id: number], number> = 
+     vi.fn((_id: number): number => {
        // console.log('MockComponent.registerInterval called');
        return 0; // Return a number as per Obsidian API
      });
  
+   // containerEl is part of ComponentType but not explicitly initialized here.
+   // It's often managed by the subclass (like View or ItemView) or passed in.
+   // For a base mock, we can declare it.
+   containerEl!: HTMLElement; // Definite assignment assertion for mocks if not init in constructor
+ 
    // Explicitly satisfy any abstract properties/methods from Events if not already handled
    // (Assuming MockEvents handles its own interface correctly)
```

---

My Liege, the `Component.ts` declarations have been fortified with explicit types for `isolatedDeclarations` and corrected `Mock` generic usage. The `Mock<T>` type from Vitest usually takes two type arguments: `Mock<ArgsTuple, ReturnType>`. For a function like `() => void`, it's `Mock<[], void>`. For functions with arguments, it's `Mock<[arg1Type, arg2Type], ReturnType>`.

The error `Generic type 'Mock<T>' requires between 0 and 1 type arguments.

---

